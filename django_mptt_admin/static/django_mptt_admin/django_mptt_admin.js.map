{"version":3,"sources":["webpack://django-mptt-admin/./node_modules/cookie/index.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/dataLoader.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/dragAndDropHandler.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/elementsRenderer.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/keyHandler.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/mouse.widget.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/node.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/nodeElement.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/saveStateHandler.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/scrollHandler.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/selectNodeHandler.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/simple.widget.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/tree.jquery.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/util.js","webpack://django-mptt-admin/./node_modules/jqtree/lib/version.js","webpack://django-mptt-admin/./node_modules/querystringify/index.js","webpack://django-mptt-admin/./node_modules/requires-port/index.js","webpack://django-mptt-admin/./node_modules/url-parse/index.js","webpack://django-mptt-admin/external \"jQuery\"","webpack://django-mptt-admin/webpack/bootstrap","webpack://django-mptt-admin/webpack/runtime/global","webpack://django-mptt-admin/./node_modules/spin.js/spin.js","webpack://django-mptt-admin/./django_mptt_admin.ts"],"names":["exports","str","options","TypeError","obj","opt","pairs","split","pairSplitRegExp","dec","decode","i","length","pair","eq_idx","indexOf","key","substr","trim","val","slice","undefined","tryDecode","decodeURIComponent","encodeURIComponent","e","__esModule","DataLoader","treeWidget","this","prototype","loadFromUrl","urlInfo","parentNode","onFinished","_this","$el","getDomElement","addLoadingClass","notifyLoading","stopLoading","removeLoadingClass","submitRequest","data","loadData","parseData","jqXHR","onLoadFailed","addClass","removeClass","jQuery","element","isLoading","node","onLoading","_triggerEvent","handleSuccess","handleError","ajaxSettings","extend","method","url","cache","dataType","success","error","toUpperCase","ajax","dataFilter","parsedData","parseJSON","extendStatics","__extends","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","call","__","constructor","create","HitAreasGenerator","DragAndDropHandler","node_1","hoveredArea","hitAreas","isDragging","currentItem","positionInfo","mouseCapture","$element","target","mustCaptureElement","onIsMoveHandle","nodeElement","_getNodeElement","onCanMove","generateHitAreas","hitAreasGenerator","tree","getTreeDimensions","bottom","generate","mouseStart","_a","pageX","pageY","refresh","offset","left","top_1","top","dragElement","DragElement","name","autoEscape","mouseDrag","move","area","findHoveredArea","canMoveToArea","isFolder","stopOpenFolderTimer","mustOpenFolderTimer","startOpenFolderTimer","updateDropHint","removeHover","removeDropHint","onDragMove","originalEvent","mouseStop","moveItem","clear","removeHitAreas","onDragStop","_getNodeElementForNode","is","onCanMoveTo","positionName","getPositionName","position","remove","previousGhost","x","y","dimensions","right","low","high","mid","is_open","Position","Inside","addDropHint","folder","openFolderTimer","window","setTimeout","_openNode","slide","openFolderDelay","clearTimeout","None","movedNode_1","targetNode_1","position_1","previousParent","parent","doMove","moveNode","empty","_refreshElements","move_info","moved_node","target_node","previous_parent","do_move","original_event","isDefaultPrevented","el","width","height","_getScrollLeft","_super","currentNode","treeBottom","positions","lastTop","iterate","previousTop","group","_i","positions_1","generateHitAreasForGroup","push","handleOpenFolder","children","addPosition","getTop","handleClosedFolder","nextNode","After","handleFirstNode","Before","handleAfterOpenFolder","handleNode","positionsInGroup","positionCount","Math","min","areaHeight","round","areaTop","VisibleNodeIterator","isFirstNode","_iterateNode","mustIterateInside","hasChildren","childrenLength_1","forEach","_","nodeName","offsetX","offsetY","$tree","text","html","css","append","util_1","ElementsRenderer","openedIconElement","createButtonElement","openedIcon","closedIconElement","closedIcon","render","fromNode","renderFromNode","renderFromRoot","createDomElements","$previousLi","li","createLi","getLevel","attachNodeData","after","isRootNode","level","ul","createUl","appendChild","children_1","child","classString","role","rtl","dragAndDrop","document","createElement","className","setAttribute","isSelected","Boolean","selectNodeHandler","isNodeSelected","isEmptyFolder","showEmptyFolder","createFolderLi","createNodeLi","onCreateLi","buttonClasses","getButtonClasses","folderClasses","getFolderClasses","iconElement","div","buttonLink","cloneNode","buttonLeft","createTitleSpan","liClasses","join","isOpen","titleSpan","classes","getBoolString","tabIndex","textContent","innerHTML","is_loading","value","createTextNode","KeyHandler","handleKeyDown","canHandleKeyboard","selectedNode","getSelectedNode","which","DOWN","moveDown","UP","moveUp","RIGHT","moveRight","LEFT","moveLeft","keyboardSupport","on","deinit","off","selectNode","getNextNode","getPreviousNode","openNode","closeNode","getParent","scrollHandler","isScrolledIntoView","find","scrollToNode","isFocusOnTree","activeElement","tagName","_containsElement","simple_widget_1","getPositionInfoFromMouseEvent","getPositionInfoFromTouch","touch","MouseWidget","apply","arguments","mouseDown","button","handleMouseDown","cancelable","preventDefault","mouseMove","handleMouseMove","mouseUp","handleMouseUp","touchStart","touches","changedTouches","touchMove","touchEnd","setMouseDelay","mouseDelay","init","get","addEventListener","passive","isMouseStarted","mouseDelayTimer","isMouseDelayMet","mouseDownInfo","removeEventListener","handleStartMouse","startMouseDelayTimer","Node","getPosition","positionNames","before","inside","none","name_1","o","isRoot","nodeClass","load_on_demand","setData","idMapping","loadFromData","removeChildren","data_1","createNode","addChild","setParent","addChildAtPosition","index","splice","removeChild","doRemoveChild","getChildIndex","inArray","callback","_iterate","movedNode","targetNode","isParentOf","getData","includeParent","getDataFromNodes","nodes","map","tmpNode","k","v","getNodeByName","getNodeByCallback","getNodeByNameMustExist","n","result","addAfter","nodeInfo","childIndex","addBefore","addParent","newParent","originalParent","prepend","getNodeById","nodeId","addNodeToIndex","id","removeNodeFromIndex","getPreviousSibling","previousIndex","getNextSibling","nextIndex","getNodesByProperty","filter","f","includeChildren","previousSibling","getLastChild","lastChild","initFromData","nodeData","childrenData","childrenData_1","addChildren","getNodeClass","BorderDropHint","FolderElement","NodeElement","mustShowBorderDropHint","GhostDropHint","select","mustSetFocus","$li","getLi","attr","$span","getSpan","focus","deselect","removeAttr","blur","getUl","open","animationSpeed","$button","getButton","buttonEl","icon","renderer","doOpen","slideDown","show","close","doClose","slideUp","hide","scrollLeft","$div","elWidth","max","elHeight","outerHeight","$hint","$ghost","moveAfter","moveBefore","moveInsideOpenFolder","moveInside","SaveStateHandler","saveState","state","JSON","stringify","getState","onSetStateFromStorage","supportsLocalStorage","localStorage","setItem","getKeyName","getStateFromStorage","jsonData","loadFromStorage","parseState","selectedNodeIds","openNodes","open_nodes","selected_node","getSelectedNodes","setInitialState","mustLoadOnDemand","openInitialNodes","resetSelection","selectInitialNodes","setInitialStateOnDemand","cbFinished","doSetInitialStateOnDemand","getNodeIdToBeSelected","isInt","onGetStateFromStorage","getItem","nodeIds","nodeIds_1","nodeDd","selectCount","nodeIds_2","addToSelection","removeFromSelection","nodeIdsParam","selectedNodes","loadingCount","newNodesIds","nodeIds_3","loadAndOpenNode","_supportsLocalStorage","sessionStorage","removeItem","testSupport","ScrollHandler","isInitialized","checkScrolling","ensureInit","checkVerticalScrolling","checkHorizontalScrolling","scrollToY","$scrollParent","scrollTop","treeTop","elementBottom","viewBottom","elementTop","viewTop","scrollParentTop","getScrollLeft","initScrollParent","setDocumentAsScrollParent","cssAttributes","hasOverFlow","cssAttributes_1","overflowValue","parents","getParentWithOverflow","handleVerticalScrollingWithScrollParent","scrollParent","offsetHeight","refreshHitAreas","handleVerticalScrollingWithDocument","dndHandler","handleHorizontalScrollingWithParent","handleHorizontalScrollingWithDocument","scrollParentOffset","canScrollRight","clientWidth","scrollWidth","canScrollLeft","rightEdge","leftEdge","isNearRightEdge","isNearLeftEdge","$document","windowWidth","SelectNodeHandler","selectedSingleNode","getSelectedNodesUnder","register","widgetClass","widgetName","getDataKey","getWidgetData","dataKey","widget","SimpleWidget","createWidget","destroyWidget","destroy","removeData","callFunction","functionName","args","widgetFunction","fn","argument1","defaults","__assign","assign","t","s","JqTreeWidget","version_1","dragAndDropHandler_1","elementsRenderer_1","dataLoader_1","keyHandler_1","mouse_widget_1","saveStateHandler_1","scrollHandler_1","selectNodeHandler_1","nodeElement_1","NODE_PARAM_IS_EMPTY","PARAM_IS_EMPTY","handleClick","clickTarget","getClickTarget","type","toggle","stopPropagation","click_event","doSelectNode","handleDblclick","handleContextmenu","closest","getNode","slideParam","Error","getTree","optionsParam","toJson","doLoadData","loadDataFromUrl","param1","param2","param3","doLoadDataFromUrl","reload","getNodeByHtmlElement","isFunction","parseParams","addNodeAfter","newNodeInfo","existingNode","newNode","addNodeBefore","addParentNode","removeNode","appendNode","parentNodeParam","prependNode","updateNode","idIsChanged","selectCurrentNode","positionIndex","saveStateHandler","nodeOffset","nodeTop","treeOffset","setState","setOption","option","keyHandler","getVersion","eventName","values","event","Event","trigger","doOpenNode","_node","_slide","_onFinished","loadFolderOnDemand","parent_1","getRtlOption","getDefaultClosedIcon","dataLoader","initData","click","dblclick","useContextMenu","getDataUrlInfo","dataUrl","setUrlInfoData","selectedNodeId","initTree","doInit","restoreState","isRestored","autoOpen","maxLevel","getAutoOpenMaxLevel","autoOpenNodes","parseInt","$target","deselectCurrentNode","dataRtl","selectOptions","mustToggle","onCanSelectNode","selectable","previous_node","deselectedNode","deselected_node","tree_data","deselectNodes","loadSubtree","selectedNodesUnderParent_1","urlInfoParam","has","input","replace","encode","prefix","isNaN","parse","query","part","parser","exec","module","port","protocol","required","qs","slashes","protocolre","RegExp","trimLeft","toString","rules","address","NaN","ignore","hash","lolcation","loc","location","g","self","finaldestination","Url","unescape","pathname","test","href","extractProtocol","match","toLowerCase","rest","relative","extracted","instruction","instructions","charAt","base","path","concat","last","unshift","up","resolve","host","hostname","username","password","auth","origin","set","pop","char","ins","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","globalThis","Function","lines","radius","scale","corners","color","fadeColor","animation","rotate","direction","speed","zIndex","shadow","Spinner","opts","spin","stop","transform","insertBefore","firstChild","borderRadius","shadows","boxShadow","regex","matches","xUnits","yUnits","end","parseBoxShadow","degrees","backgroundLine","background","getColor","transformOrigin","delay","line","normalizeShadow","drawLines","requestAnimationFrame","cancelAnimationFrame","animateId","props","prop","style","idx","normalized","shadows_1","xy","convertOffset","radians","PI","sin","cos","csrfCookieName","errorNode","insertAtUrl","URL","spinners","handleLoading","spinner","treeOptions","$title","insert_at","querystring","insertUrlString","tabindex","gettext","eventParam","info","target_id","move_url","beforeSend","xhr","setRequestHeader","cookie","querySelector"],"mappings":"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","file":"django_mptt_admin.js","sourcesContent":["/*!\n * cookie\n * Copyright(c) 2012-2014 Roman Shtylman\n * Copyright(c) 2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module exports.\n * @public\n */\n\nexports.parse = parse;\nexports.serialize = serialize;\n\n/**\n * Module variables.\n * @private\n */\n\nvar decode = decodeURIComponent;\nvar encode = encodeURIComponent;\nvar pairSplitRegExp = /; */;\n\n/**\n * RegExp to match field-content in RFC 7230 sec 3.2\n *\n * field-content = field-vchar [ 1*( SP / HTAB ) field-vchar ]\n * field-vchar   = VCHAR / obs-text\n * obs-text      = %x80-FF\n */\n\nvar fieldContentRegExp = /^[\\u0009\\u0020-\\u007e\\u0080-\\u00ff]+$/;\n\n/**\n * Parse a cookie header.\n *\n * Parse the given cookie header string into an object\n * The object has the various cookies as keys(names) => values\n *\n * @param {string} str\n * @param {object} [options]\n * @return {object}\n * @public\n */\n\nfunction parse(str, options) {\n  if (typeof str !== 'string') {\n    throw new TypeError('argument str must be a string');\n  }\n\n  var obj = {}\n  var opt = options || {};\n  var pairs = str.split(pairSplitRegExp);\n  var dec = opt.decode || decode;\n\n  for (var i = 0; i < pairs.length; i++) {\n    var pair = pairs[i];\n    var eq_idx = pair.indexOf('=');\n\n    // skip things that don't look like key=value\n    if (eq_idx < 0) {\n      continue;\n    }\n\n    var key = pair.substr(0, eq_idx).trim()\n    var val = pair.substr(++eq_idx, pair.length).trim();\n\n    // quoted values\n    if ('\"' == val[0]) {\n      val = val.slice(1, -1);\n    }\n\n    // only assign once\n    if (undefined == obj[key]) {\n      obj[key] = tryDecode(val, dec);\n    }\n  }\n\n  return obj;\n}\n\n/**\n * Serialize data into a cookie header.\n *\n * Serialize the a name value pair into a cookie string suitable for\n * http headers. An optional options object specified cookie parameters.\n *\n * serialize('foo', 'bar', { httpOnly: true })\n *   => \"foo=bar; httpOnly\"\n *\n * @param {string} name\n * @param {string} val\n * @param {object} [options]\n * @return {string}\n * @public\n */\n\nfunction serialize(name, val, options) {\n  var opt = options || {};\n  var enc = opt.encode || encode;\n\n  if (typeof enc !== 'function') {\n    throw new TypeError('option encode is invalid');\n  }\n\n  if (!fieldContentRegExp.test(name)) {\n    throw new TypeError('argument name is invalid');\n  }\n\n  var value = enc(val);\n\n  if (value && !fieldContentRegExp.test(value)) {\n    throw new TypeError('argument val is invalid');\n  }\n\n  var str = name + '=' + value;\n\n  if (null != opt.maxAge) {\n    var maxAge = opt.maxAge - 0;\n\n    if (isNaN(maxAge) || !isFinite(maxAge)) {\n      throw new TypeError('option maxAge is invalid')\n    }\n\n    str += '; Max-Age=' + Math.floor(maxAge);\n  }\n\n  if (opt.domain) {\n    if (!fieldContentRegExp.test(opt.domain)) {\n      throw new TypeError('option domain is invalid');\n    }\n\n    str += '; Domain=' + opt.domain;\n  }\n\n  if (opt.path) {\n    if (!fieldContentRegExp.test(opt.path)) {\n      throw new TypeError('option path is invalid');\n    }\n\n    str += '; Path=' + opt.path;\n  }\n\n  if (opt.expires) {\n    if (typeof opt.expires.toUTCString !== 'function') {\n      throw new TypeError('option expires is invalid');\n    }\n\n    str += '; Expires=' + opt.expires.toUTCString();\n  }\n\n  if (opt.httpOnly) {\n    str += '; HttpOnly';\n  }\n\n  if (opt.secure) {\n    str += '; Secure';\n  }\n\n  if (opt.sameSite) {\n    var sameSite = typeof opt.sameSite === 'string'\n      ? opt.sameSite.toLowerCase() : opt.sameSite;\n\n    switch (sameSite) {\n      case true:\n        str += '; SameSite=Strict';\n        break;\n      case 'lax':\n        str += '; SameSite=Lax';\n        break;\n      case 'strict':\n        str += '; SameSite=Strict';\n        break;\n      case 'none':\n        str += '; SameSite=None';\n        break;\n      default:\n        throw new TypeError('option sameSite is invalid');\n    }\n  }\n\n  return str;\n}\n\n/**\n * Try decoding a string using a decoding function.\n *\n * @param {string} str\n * @param {function} decode\n * @private\n */\n\nfunction tryDecode(str, decode) {\n  try {\n    return decode(str);\n  } catch (e) {\n    return str;\n  }\n}\n","\"use strict\";\nexports.__esModule = true;\nvar DataLoader = /** @class */ (function () {\n    function DataLoader(treeWidget) {\n        this.treeWidget = treeWidget;\n    }\n    DataLoader.prototype.loadFromUrl = function (urlInfo, parentNode, onFinished) {\n        var _this = this;\n        if (!urlInfo) {\n            return;\n        }\n        var $el = this.getDomElement(parentNode);\n        this.addLoadingClass($el);\n        this.notifyLoading(true, parentNode, $el);\n        var stopLoading = function () {\n            _this.removeLoadingClass($el);\n            _this.notifyLoading(false, parentNode, $el);\n        };\n        var handleSuccess = function (data) {\n            stopLoading();\n            _this.treeWidget.loadData(_this.parseData(data), parentNode);\n            if (onFinished && typeof onFinished === \"function\") {\n                onFinished();\n            }\n        };\n        var handleError = function (jqXHR) {\n            stopLoading();\n            if (_this.treeWidget.options.onLoadFailed) {\n                _this.treeWidget.options.onLoadFailed(jqXHR);\n            }\n        };\n        this.submitRequest(urlInfo, handleSuccess, handleError);\n    };\n    DataLoader.prototype.addLoadingClass = function ($el) {\n        if ($el) {\n            $el.addClass(\"jqtree-loading\");\n        }\n    };\n    DataLoader.prototype.removeLoadingClass = function ($el) {\n        if ($el) {\n            $el.removeClass(\"jqtree-loading\");\n        }\n    };\n    DataLoader.prototype.getDomElement = function (parentNode) {\n        if (parentNode) {\n            return jQuery(parentNode.element);\n        }\n        else {\n            return this.treeWidget.element;\n        }\n    };\n    DataLoader.prototype.notifyLoading = function (isLoading, node, $el) {\n        if (this.treeWidget.options.onLoading) {\n            this.treeWidget.options.onLoading(isLoading, node, $el);\n        }\n        this.treeWidget._triggerEvent(\"tree.loading_data\", {\n            isLoading: isLoading,\n            node: node,\n            $el: $el\n        });\n    };\n    DataLoader.prototype.submitRequest = function (urlInfo, handleSuccess, handleError) {\n        var ajaxSettings = jQuery.extend({ method: \"GET\" }, typeof urlInfo === \"string\" ? { url: urlInfo } : urlInfo, {\n            cache: false,\n            dataType: \"json\",\n            success: handleSuccess,\n            error: handleError\n        });\n        ajaxSettings.method = ajaxSettings.method.toUpperCase();\n        void jQuery.ajax(ajaxSettings);\n    };\n    DataLoader.prototype.parseData = function (data) {\n        var dataFilter = this.treeWidget.options.dataFilter;\n        var getParsedData = function () {\n            if (typeof data === \"string\") {\n                return jQuery.parseJSON(data);\n            }\n            else {\n                return data;\n            }\n        };\n        var parsedData = getParsedData();\n        if (dataFilter) {\n            return dataFilter(parsedData);\n        }\n        else {\n            return parsedData;\n        }\n    };\n    return DataLoader;\n}());\nexports[\"default\"] = DataLoader;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nexports.__esModule = true;\nexports.HitAreasGenerator = exports.DragAndDropHandler = void 0;\nvar jQuery = require(\"jquery\");\nvar node_1 = require(\"./node\");\nvar DragAndDropHandler = /** @class */ (function () {\n    function DragAndDropHandler(treeWidget) {\n        this.treeWidget = treeWidget;\n        this.hoveredArea = null;\n        this.hitAreas = [];\n        this.isDragging = false;\n        this.currentItem = null;\n        this.positionInfo = null;\n    }\n    DragAndDropHandler.prototype.mouseCapture = function (positionInfo) {\n        var $element = jQuery(positionInfo.target);\n        if (!this.mustCaptureElement($element)) {\n            return null;\n        }\n        if (this.treeWidget.options.onIsMoveHandle &&\n            !this.treeWidget.options.onIsMoveHandle($element)) {\n            return null;\n        }\n        var nodeElement = this.treeWidget._getNodeElement($element);\n        if (nodeElement && this.treeWidget.options.onCanMove) {\n            if (!this.treeWidget.options.onCanMove(nodeElement.node)) {\n                nodeElement = null;\n            }\n        }\n        this.currentItem = nodeElement;\n        return this.currentItem != null;\n    };\n    DragAndDropHandler.prototype.generateHitAreas = function () {\n        if (!this.currentItem) {\n            this.hitAreas = [];\n        }\n        else {\n            var hitAreasGenerator = new HitAreasGenerator(this.treeWidget.tree, this.currentItem.node, this.getTreeDimensions().bottom);\n            this.hitAreas = hitAreasGenerator.generate();\n        }\n    };\n    DragAndDropHandler.prototype.mouseStart = function (positionInfo) {\n        var _a;\n        if (!this.currentItem ||\n            positionInfo.pageX === undefined ||\n            positionInfo.pageY === undefined) {\n            return false;\n        }\n        else {\n            this.refresh();\n            var offset = jQuery(positionInfo.target).offset();\n            var left = offset ? offset.left : 0;\n            var top_1 = offset ? offset.top : 0;\n            var node = this.currentItem.node;\n            this.dragElement = new DragElement(node.name, positionInfo.pageX - left, positionInfo.pageY - top_1, this.treeWidget.element, (_a = this.treeWidget.options.autoEscape) !== null && _a !== void 0 ? _a : true);\n            this.isDragging = true;\n            this.positionInfo = positionInfo;\n            this.currentItem.$element.addClass(\"jqtree-moving\");\n            return true;\n        }\n    };\n    DragAndDropHandler.prototype.mouseDrag = function (positionInfo) {\n        if (!this.currentItem ||\n            !this.dragElement ||\n            positionInfo.pageX === undefined ||\n            positionInfo.pageY === undefined) {\n            return false;\n        }\n        else {\n            this.dragElement.move(positionInfo.pageX, positionInfo.pageY);\n            this.positionInfo = positionInfo;\n            var area = this.findHoveredArea(positionInfo.pageX, positionInfo.pageY);\n            var canMoveTo = this.canMoveToArea(area);\n            if (canMoveTo && area) {\n                if (!area.node.isFolder()) {\n                    this.stopOpenFolderTimer();\n                }\n                if (this.hoveredArea !== area) {\n                    this.hoveredArea = area;\n                    // If this is a closed folder, start timer to open it\n                    if (this.mustOpenFolderTimer(area)) {\n                        this.startOpenFolderTimer(area.node);\n                    }\n                    else {\n                        this.stopOpenFolderTimer();\n                    }\n                    this.updateDropHint();\n                }\n            }\n            else {\n                this.removeHover();\n                this.removeDropHint();\n                this.stopOpenFolderTimer();\n            }\n            if (!area) {\n                if (this.treeWidget.options.onDragMove) {\n                    this.treeWidget.options.onDragMove(this.currentItem.node, positionInfo.originalEvent);\n                }\n            }\n            return true;\n        }\n    };\n    DragAndDropHandler.prototype.mouseStop = function (positionInfo) {\n        this.moveItem(positionInfo);\n        this.clear();\n        this.removeHover();\n        this.removeDropHint();\n        this.removeHitAreas();\n        var currentItem = this.currentItem;\n        if (this.currentItem) {\n            this.currentItem.$element.removeClass(\"jqtree-moving\");\n            this.currentItem = null;\n        }\n        this.isDragging = false;\n        this.positionInfo = null;\n        if (!this.hoveredArea && currentItem) {\n            if (this.treeWidget.options.onDragStop) {\n                this.treeWidget.options.onDragStop(currentItem.node, positionInfo.originalEvent);\n            }\n        }\n        return false;\n    };\n    DragAndDropHandler.prototype.refresh = function () {\n        this.removeHitAreas();\n        if (this.currentItem) {\n            this.generateHitAreas();\n            this.currentItem = this.treeWidget._getNodeElementForNode(this.currentItem.node);\n            if (this.isDragging) {\n                this.currentItem.$element.addClass(\"jqtree-moving\");\n            }\n        }\n    };\n    DragAndDropHandler.prototype.mustCaptureElement = function ($element) {\n        return !$element.is(\"input,select,textarea\");\n    };\n    DragAndDropHandler.prototype.canMoveToArea = function (area) {\n        if (!area || !this.currentItem) {\n            return false;\n        }\n        else if (this.treeWidget.options.onCanMoveTo) {\n            var positionName = node_1.getPositionName(area.position);\n            return this.treeWidget.options.onCanMoveTo(this.currentItem.node, area.node, positionName);\n        }\n        else {\n            return true;\n        }\n    };\n    DragAndDropHandler.prototype.removeHitAreas = function () {\n        this.hitAreas = [];\n    };\n    DragAndDropHandler.prototype.clear = function () {\n        if (this.dragElement) {\n            this.dragElement.remove();\n            this.dragElement = null;\n        }\n    };\n    DragAndDropHandler.prototype.removeDropHint = function () {\n        if (this.previousGhost) {\n            this.previousGhost.remove();\n        }\n    };\n    DragAndDropHandler.prototype.removeHover = function () {\n        this.hoveredArea = null;\n    };\n    DragAndDropHandler.prototype.findHoveredArea = function (x, y) {\n        var dimensions = this.getTreeDimensions();\n        if (x < dimensions.left ||\n            y < dimensions.top ||\n            x > dimensions.right ||\n            y > dimensions.bottom) {\n            return null;\n        }\n        var low = 0;\n        var high = this.hitAreas.length;\n        while (low < high) {\n            var mid = (low + high) >> 1;\n            var area = this.hitAreas[mid];\n            if (y < area.top) {\n                high = mid;\n            }\n            else if (y > area.bottom) {\n                low = mid + 1;\n            }\n            else {\n                return area;\n            }\n        }\n        return null;\n    };\n    DragAndDropHandler.prototype.mustOpenFolderTimer = function (area) {\n        var node = area.node;\n        return (node.isFolder() &&\n            !node.is_open &&\n            area.position === node_1.Position.Inside);\n    };\n    DragAndDropHandler.prototype.updateDropHint = function () {\n        if (!this.hoveredArea) {\n            return;\n        }\n        // remove previous drop hint\n        this.removeDropHint();\n        // add new drop hint\n        var nodeElement = this.treeWidget._getNodeElementForNode(this.hoveredArea.node);\n        this.previousGhost = nodeElement.addDropHint(this.hoveredArea.position);\n    };\n    DragAndDropHandler.prototype.startOpenFolderTimer = function (folder) {\n        var _this = this;\n        var openFolder = function () {\n            _this.treeWidget._openNode(folder, _this.treeWidget.options.slide, function () {\n                _this.refresh();\n                _this.updateDropHint();\n            });\n        };\n        this.stopOpenFolderTimer();\n        this.openFolderTimer = window.setTimeout(openFolder, this.treeWidget.options.openFolderDelay);\n    };\n    DragAndDropHandler.prototype.stopOpenFolderTimer = function () {\n        if (this.openFolderTimer) {\n            clearTimeout(this.openFolderTimer);\n            this.openFolderTimer = null;\n        }\n    };\n    DragAndDropHandler.prototype.moveItem = function (positionInfo) {\n        var _this = this;\n        if (this.currentItem &&\n            this.hoveredArea &&\n            this.hoveredArea.position !== node_1.Position.None &&\n            this.canMoveToArea(this.hoveredArea)) {\n            var movedNode_1 = this.currentItem.node;\n            var targetNode_1 = this.hoveredArea.node;\n            var position_1 = this.hoveredArea.position;\n            var previousParent = movedNode_1.parent;\n            if (position_1 === node_1.Position.Inside) {\n                this.hoveredArea.node.is_open = true;\n            }\n            var doMove = function () {\n                _this.treeWidget.tree.moveNode(movedNode_1, targetNode_1, position_1);\n                _this.treeWidget.element.empty();\n                _this.treeWidget._refreshElements(null);\n            };\n            var event_1 = this.treeWidget._triggerEvent(\"tree.move\", {\n                move_info: {\n                    moved_node: movedNode_1,\n                    target_node: targetNode_1,\n                    position: node_1.getPositionName(position_1),\n                    previous_parent: previousParent,\n                    do_move: doMove,\n                    original_event: positionInfo.originalEvent\n                }\n            });\n            if (!event_1.isDefaultPrevented()) {\n                doMove();\n            }\n        }\n    };\n    DragAndDropHandler.prototype.getTreeDimensions = function () {\n        // Return the dimensions of the tree. Add a margin to the bottom to allow\n        // to drag-and-drop after the last element.\n        var offset = this.treeWidget.element.offset();\n        if (!offset) {\n            return { left: 0, top: 0, right: 0, bottom: 0 };\n        }\n        else {\n            var el = this.treeWidget.element;\n            var width = el.width() || 0;\n            var height = el.height() || 0;\n            var left = offset.left + this.treeWidget._getScrollLeft();\n            return {\n                left: left,\n                top: offset.top,\n                right: left + width,\n                bottom: offset.top + height + 16\n            };\n        }\n    };\n    return DragAndDropHandler;\n}());\nexports.DragAndDropHandler = DragAndDropHandler;\nvar VisibleNodeIterator = /** @class */ (function () {\n    function VisibleNodeIterator(tree) {\n        this.tree = tree;\n    }\n    VisibleNodeIterator.prototype.iterate = function () {\n        var _this = this;\n        var isFirstNode = true;\n        var _iterateNode = function (node, nextNode) {\n            var mustIterateInside = (node.is_open || !node.element) && node.hasChildren();\n            var $element = null;\n            if (node.element) {\n                $element = jQuery(node.element);\n                if (!$element.is(\":visible\")) {\n                    return;\n                }\n                if (isFirstNode) {\n                    _this.handleFirstNode(node);\n                    isFirstNode = false;\n                }\n                if (!node.hasChildren()) {\n                    _this.handleNode(node, nextNode, $element);\n                }\n                else if (node.is_open) {\n                    if (!_this.handleOpenFolder(node, $element)) {\n                        mustIterateInside = false;\n                    }\n                }\n                else {\n                    _this.handleClosedFolder(node, nextNode, $element);\n                }\n            }\n            if (mustIterateInside) {\n                var childrenLength_1 = node.children.length;\n                node.children.forEach(function (_, i) {\n                    if (i === childrenLength_1 - 1) {\n                        _iterateNode(node.children[i], null);\n                    }\n                    else {\n                        _iterateNode(node.children[i], node.children[i + 1]);\n                    }\n                });\n                if (node.is_open && $element) {\n                    _this.handleAfterOpenFolder(node, nextNode);\n                }\n            }\n        };\n        _iterateNode(this.tree, null);\n    };\n    return VisibleNodeIterator;\n}());\nvar HitAreasGenerator = /** @class */ (function (_super) {\n    __extends(HitAreasGenerator, _super);\n    function HitAreasGenerator(tree, currentNode, treeBottom) {\n        var _this = _super.call(this, tree) || this;\n        _this.currentNode = currentNode;\n        _this.treeBottom = treeBottom;\n        return _this;\n    }\n    HitAreasGenerator.prototype.generate = function () {\n        this.positions = [];\n        this.lastTop = 0;\n        this.iterate();\n        return this.generateHitAreas(this.positions);\n    };\n    HitAreasGenerator.prototype.generateHitAreas = function (positions) {\n        var previousTop = -1;\n        var group = [];\n        var hitAreas = [];\n        for (var _i = 0, positions_1 = positions; _i < positions_1.length; _i++) {\n            var position = positions_1[_i];\n            if (position.top !== previousTop && group.length) {\n                if (group.length) {\n                    this.generateHitAreasForGroup(hitAreas, group, previousTop, position.top);\n                }\n                previousTop = position.top;\n                group = [];\n            }\n            group.push(position);\n        }\n        this.generateHitAreasForGroup(hitAreas, group, previousTop, this.treeBottom);\n        return hitAreas;\n    };\n    HitAreasGenerator.prototype.handleOpenFolder = function (node, $element) {\n        if (node === this.currentNode) {\n            // Cannot move inside current item\n            // Stop iterating\n            return false;\n        }\n        // Cannot move before current item\n        if (node.children[0] !== this.currentNode) {\n            this.addPosition(node, node_1.Position.Inside, this.getTop($element));\n        }\n        // Continue iterating\n        return true;\n    };\n    HitAreasGenerator.prototype.handleClosedFolder = function (node, nextNode, $element) {\n        var top = this.getTop($element);\n        if (node === this.currentNode) {\n            // Cannot move after current item\n            this.addPosition(node, node_1.Position.None, top);\n        }\n        else {\n            this.addPosition(node, node_1.Position.Inside, top);\n            // Cannot move before current item\n            if (nextNode !== this.currentNode) {\n                this.addPosition(node, node_1.Position.After, top);\n            }\n        }\n    };\n    HitAreasGenerator.prototype.handleFirstNode = function (node) {\n        if (node !== this.currentNode) {\n            this.addPosition(node, node_1.Position.Before, this.getTop(jQuery(node.element)));\n        }\n    };\n    HitAreasGenerator.prototype.handleAfterOpenFolder = function (node, nextNode) {\n        if (node === this.currentNode || nextNode === this.currentNode) {\n            // Cannot move before or after current item\n            this.addPosition(node, node_1.Position.None, this.lastTop);\n        }\n        else {\n            this.addPosition(node, node_1.Position.After, this.lastTop);\n        }\n    };\n    HitAreasGenerator.prototype.handleNode = function (node, nextNode, $element) {\n        var top = this.getTop($element);\n        if (node === this.currentNode) {\n            // Cannot move inside current item\n            this.addPosition(node, node_1.Position.None, top);\n        }\n        else {\n            this.addPosition(node, node_1.Position.Inside, top);\n        }\n        if (nextNode === this.currentNode || node === this.currentNode) {\n            // Cannot move before or after current item\n            this.addPosition(node, node_1.Position.None, top);\n        }\n        else {\n            this.addPosition(node, node_1.Position.After, top);\n        }\n    };\n    HitAreasGenerator.prototype.getTop = function ($element) {\n        var offset = $element.offset();\n        return offset ? offset.top : 0;\n    };\n    HitAreasGenerator.prototype.addPosition = function (node, position, top) {\n        var area = {\n            top: top,\n            bottom: 0,\n            node: node,\n            position: position\n        };\n        this.positions.push(area);\n        this.lastTop = top;\n    };\n    HitAreasGenerator.prototype.generateHitAreasForGroup = function (hitAreas, positionsInGroup, top, bottom) {\n        // limit positions in group\n        var positionCount = Math.min(positionsInGroup.length, 4);\n        var areaHeight = Math.round((bottom - top) / positionCount);\n        var areaTop = top;\n        var i = 0;\n        while (i < positionCount) {\n            var position = positionsInGroup[i];\n            hitAreas.push({\n                top: areaTop,\n                bottom: areaTop + areaHeight,\n                node: position.node,\n                position: position.position\n            });\n            areaTop += areaHeight;\n            i += 1;\n        }\n    };\n    return HitAreasGenerator;\n}(VisibleNodeIterator));\nexports.HitAreasGenerator = HitAreasGenerator;\nvar DragElement = /** @class */ (function () {\n    function DragElement(nodeName, offsetX, offsetY, $tree, autoEscape) {\n        this.offsetX = offsetX;\n        this.offsetY = offsetY;\n        this.$element = jQuery(\"<span>\").addClass(\"jqtree-title jqtree-dragging\");\n        if (autoEscape) {\n            this.$element.text(nodeName);\n        }\n        else {\n            this.$element.html(nodeName);\n        }\n        this.$element.css(\"position\", \"absolute\");\n        $tree.append(this.$element);\n    }\n    DragElement.prototype.move = function (pageX, pageY) {\n        this.$element.offset({\n            left: pageX - this.offsetX,\n            top: pageY - this.offsetY\n        });\n    };\n    DragElement.prototype.remove = function () {\n        this.$element.remove();\n    };\n    return DragElement;\n}());\n","\"use strict\";\nexports.__esModule = true;\nvar util_1 = require(\"./util\");\nvar ElementsRenderer = /** @class */ (function () {\n    function ElementsRenderer(treeWidget) {\n        this.treeWidget = treeWidget;\n        this.openedIconElement = this.createButtonElement(treeWidget.options.openedIcon || \"+\");\n        this.closedIconElement = this.createButtonElement(treeWidget.options.closedIcon || \"-\");\n    }\n    ElementsRenderer.prototype.render = function (fromNode) {\n        if (fromNode && fromNode.parent) {\n            this.renderFromNode(fromNode);\n        }\n        else {\n            this.renderFromRoot();\n        }\n    };\n    ElementsRenderer.prototype.renderFromRoot = function () {\n        var $element = this.treeWidget.element;\n        $element.empty();\n        this.createDomElements($element[0], this.treeWidget.tree.children, true, 1);\n    };\n    ElementsRenderer.prototype.renderFromNode = function (node) {\n        // remember current li\n        var $previousLi = jQuery(node.element);\n        // create element\n        var li = this.createLi(node, node.getLevel());\n        this.attachNodeData(node, li);\n        // add element to dom\n        $previousLi.after(li);\n        // remove previous li\n        $previousLi.remove();\n        // create children\n        if (node.children) {\n            this.createDomElements(li, node.children, false, node.getLevel() + 1);\n        }\n    };\n    ElementsRenderer.prototype.createDomElements = function (element, children, isRootNode, level) {\n        var ul = this.createUl(isRootNode);\n        element.appendChild(ul);\n        for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {\n            var child = children_1[_i];\n            var li = this.createLi(child, level);\n            ul.appendChild(li);\n            this.attachNodeData(child, li);\n            if (child.hasChildren()) {\n                this.createDomElements(li, child.children, false, level + 1);\n            }\n        }\n    };\n    ElementsRenderer.prototype.attachNodeData = function (node, li) {\n        node.element = li;\n        jQuery(li).data(\"node\", node);\n    };\n    ElementsRenderer.prototype.createUl = function (isRootNode) {\n        var classString;\n        var role;\n        if (!isRootNode) {\n            classString = \"\";\n            role = \"group\";\n        }\n        else {\n            classString = \"jqtree-tree\";\n            role = \"tree\";\n            if (this.treeWidget.options.rtl) {\n                classString += \" jqtree-rtl\";\n            }\n        }\n        if (this.treeWidget.options.dragAndDrop) {\n            classString += \" jqtree-dnd\";\n        }\n        var ul = document.createElement(\"ul\");\n        ul.className = \"jqtree_common \" + classString;\n        ul.setAttribute(\"role\", role);\n        return ul;\n    };\n    ElementsRenderer.prototype.createLi = function (node, level) {\n        var isSelected = Boolean(this.treeWidget.selectNodeHandler.isNodeSelected(node));\n        var mustShowFolder = node.isFolder() ||\n            (node.isEmptyFolder && this.treeWidget.options.showEmptyFolder);\n        var li = mustShowFolder\n            ? this.createFolderLi(node, level, isSelected)\n            : this.createNodeLi(node, level, isSelected);\n        if (this.treeWidget.options.onCreateLi) {\n            this.treeWidget.options.onCreateLi(node, jQuery(li), isSelected);\n        }\n        return li;\n    };\n    ElementsRenderer.prototype.createFolderLi = function (node, level, isSelected) {\n        var buttonClasses = this.getButtonClasses(node);\n        var folderClasses = this.getFolderClasses(node, isSelected);\n        var iconElement = node.is_open\n            ? this.openedIconElement\n            : this.closedIconElement;\n        // li\n        var li = document.createElement(\"li\");\n        li.className = \"jqtree_common \" + folderClasses;\n        li.setAttribute(\"role\", \"presentation\");\n        // div\n        var div = document.createElement(\"div\");\n        div.className = \"jqtree-element jqtree_common\";\n        div.setAttribute(\"role\", \"presentation\");\n        li.appendChild(div);\n        // button link\n        var buttonLink = document.createElement(\"a\");\n        buttonLink.className = buttonClasses;\n        buttonLink.appendChild(iconElement.cloneNode(true));\n        buttonLink.setAttribute(\"role\", \"presentation\");\n        buttonLink.setAttribute(\"aria-hidden\", \"true\");\n        if (this.treeWidget.options.buttonLeft) {\n            div.appendChild(buttonLink);\n        }\n        // title span\n        div.appendChild(this.createTitleSpan(node.name, level, isSelected, node.is_open, true));\n        if (!this.treeWidget.options.buttonLeft) {\n            div.appendChild(buttonLink);\n        }\n        return li;\n    };\n    ElementsRenderer.prototype.createNodeLi = function (node, level, isSelected) {\n        var liClasses = [\"jqtree_common\"];\n        if (isSelected) {\n            liClasses.push(\"jqtree-selected\");\n        }\n        var classString = liClasses.join(\" \");\n        // li\n        var li = document.createElement(\"li\");\n        li.className = classString;\n        li.setAttribute(\"role\", \"presentation\");\n        // div\n        var div = document.createElement(\"div\");\n        div.className = \"jqtree-element jqtree_common\";\n        div.setAttribute(\"role\", \"presentation\");\n        li.appendChild(div);\n        // title span\n        div.appendChild(this.createTitleSpan(node.name, level, isSelected, node.is_open, false));\n        return li;\n    };\n    ElementsRenderer.prototype.createTitleSpan = function (nodeName, level, isSelected, isOpen, isFolder) {\n        var titleSpan = document.createElement(\"span\");\n        var classes = \"jqtree-title jqtree_common\";\n        if (isFolder) {\n            classes += \" jqtree-title-folder\";\n        }\n        titleSpan.className = classes;\n        titleSpan.setAttribute(\"role\", \"treeitem\");\n        titleSpan.setAttribute(\"aria-level\", \"\" + level);\n        titleSpan.setAttribute(\"aria-selected\", util_1.getBoolString(isSelected));\n        titleSpan.setAttribute(\"aria-expanded\", util_1.getBoolString(isOpen));\n        if (isSelected) {\n            var tabIndex = this.treeWidget.options.tabIndex;\n            if (tabIndex !== undefined) {\n                titleSpan.setAttribute(\"tabindex\", \"\" + tabIndex);\n            }\n        }\n        if (this.treeWidget.options.autoEscape) {\n            titleSpan.textContent = nodeName;\n        }\n        else {\n            titleSpan.innerHTML = nodeName;\n        }\n        return titleSpan;\n    };\n    ElementsRenderer.prototype.getButtonClasses = function (node) {\n        var classes = [\"jqtree-toggler\", \"jqtree_common\"];\n        if (!node.is_open) {\n            classes.push(\"jqtree-closed\");\n        }\n        if (this.treeWidget.options.buttonLeft) {\n            classes.push(\"jqtree-toggler-left\");\n        }\n        else {\n            classes.push(\"jqtree-toggler-right\");\n        }\n        return classes.join(\" \");\n    };\n    ElementsRenderer.prototype.getFolderClasses = function (node, isSelected) {\n        var classes = [\"jqtree-folder\"];\n        if (!node.is_open) {\n            classes.push(\"jqtree-closed\");\n        }\n        if (isSelected) {\n            classes.push(\"jqtree-selected\");\n        }\n        if (node.is_loading) {\n            classes.push(\"jqtree-loading\");\n        }\n        return classes.join(\" \");\n    };\n    ElementsRenderer.prototype.createButtonElement = function (value) {\n        if (typeof value === \"string\") {\n            // convert value to html\n            var div = document.createElement(\"div\");\n            div.innerHTML = value;\n            return document.createTextNode(div.innerHTML);\n        }\n        else {\n            return jQuery(value)[0];\n        }\n    };\n    return ElementsRenderer;\n}());\nexports[\"default\"] = ElementsRenderer;\n","\"use strict\";\nexports.__esModule = true;\nvar KeyHandler = /** @class */ (function () {\n    function KeyHandler(treeWidget) {\n        var _this = this;\n        this.handleKeyDown = function (e) {\n            if (!_this.canHandleKeyboard()) {\n                return true;\n            }\n            var selectedNode = _this.treeWidget.getSelectedNode();\n            if (!selectedNode) {\n                return true;\n            }\n            var key = e.which;\n            switch (key) {\n                case KeyHandler.DOWN:\n                    return _this.moveDown(selectedNode);\n                case KeyHandler.UP:\n                    return _this.moveUp(selectedNode);\n                case KeyHandler.RIGHT:\n                    return _this.moveRight(selectedNode);\n                case KeyHandler.LEFT:\n                    return _this.moveLeft(selectedNode);\n                default:\n                    return true;\n            }\n        };\n        this.treeWidget = treeWidget;\n        if (treeWidget.options.keyboardSupport) {\n            jQuery(document).on(\"keydown.jqtree\", this.handleKeyDown);\n        }\n    }\n    KeyHandler.prototype.deinit = function () {\n        jQuery(document).off(\"keydown.jqtree\");\n    };\n    KeyHandler.prototype.moveDown = function (selectedNode) {\n        return this.selectNode(selectedNode.getNextNode());\n    };\n    KeyHandler.prototype.moveUp = function (selectedNode) {\n        return this.selectNode(selectedNode.getPreviousNode());\n    };\n    KeyHandler.prototype.moveRight = function (selectedNode) {\n        if (!selectedNode.isFolder()) {\n            return true;\n        }\n        else {\n            // folder node\n            if (selectedNode.is_open) {\n                // Right moves to the first child of an open node\n                return this.selectNode(selectedNode.getNextNode());\n            }\n            else {\n                // Right expands a closed node\n                this.treeWidget.openNode(selectedNode);\n                return false;\n            }\n        }\n    };\n    KeyHandler.prototype.moveLeft = function (selectedNode) {\n        if (selectedNode.isFolder() && selectedNode.is_open) {\n            // Left on an open node closes the node\n            this.treeWidget.closeNode(selectedNode);\n            return false;\n        }\n        else {\n            // Left on a closed or end node moves focus to the node's parent\n            return this.selectNode(selectedNode.getParent());\n        }\n    };\n    KeyHandler.prototype.selectNode = function (node) {\n        if (!node) {\n            return true;\n        }\n        else {\n            this.treeWidget.selectNode(node);\n            if (!this.treeWidget.scrollHandler.isScrolledIntoView(jQuery(node.element).find(\".jqtree-element\"))) {\n                this.treeWidget.scrollToNode(node);\n            }\n            return false;\n        }\n    };\n    KeyHandler.prototype.canHandleKeyboard = function () {\n        return ((this.treeWidget.options.keyboardSupport || false) &&\n            this.isFocusOnTree());\n    };\n    KeyHandler.prototype.isFocusOnTree = function () {\n        var activeElement = document.activeElement;\n        return Boolean(activeElement &&\n            activeElement.tagName === \"SPAN\" &&\n            this.treeWidget._containsElement(activeElement));\n    };\n    KeyHandler.LEFT = 37;\n    KeyHandler.UP = 38;\n    KeyHandler.RIGHT = 39;\n    KeyHandler.DOWN = 40;\n    return KeyHandler;\n}());\nexports[\"default\"] = KeyHandler;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nexports.__esModule = true;\n/*\nThis widget does the same a the mouse widget in jqueryui.\n*/\nvar simple_widget_1 = require(\"./simple.widget\");\nvar getPositionInfoFromMouseEvent = function (e) { return ({\n    pageX: e.pageX,\n    pageY: e.pageY,\n    target: e.target,\n    originalEvent: e\n}); };\nvar getPositionInfoFromTouch = function (touch, e) { return ({\n    pageX: touch.pageX,\n    pageY: touch.pageY,\n    target: touch.target,\n    originalEvent: e\n}); };\nvar MouseWidget = /** @class */ (function (_super) {\n    __extends(MouseWidget, _super);\n    function MouseWidget() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.mouseDown = function (e) {\n            // Left mouse button?\n            if (e.button !== 0) {\n                return;\n            }\n            var result = _this.handleMouseDown(getPositionInfoFromMouseEvent(e));\n            if (result && e.cancelable) {\n                e.preventDefault();\n            }\n        };\n        _this.mouseMove = function (e) {\n            _this.handleMouseMove(e, getPositionInfoFromMouseEvent(e));\n        };\n        _this.mouseUp = function (e) {\n            _this.handleMouseUp(getPositionInfoFromMouseEvent(e));\n        };\n        _this.touchStart = function (e) {\n            if (!e) {\n                return;\n            }\n            if (e.touches.length > 1) {\n                return;\n            }\n            var touch = e.changedTouches[0];\n            _this.handleMouseDown(getPositionInfoFromTouch(touch, e));\n        };\n        _this.touchMove = function (e) {\n            if (!e) {\n                return;\n            }\n            if (e.touches.length > 1) {\n                return;\n            }\n            var touch = e.changedTouches[0];\n            _this.handleMouseMove(e, getPositionInfoFromTouch(touch, e));\n        };\n        _this.touchEnd = function (e) {\n            if (!e) {\n                return;\n            }\n            if (e.touches.length > 1) {\n                return;\n            }\n            var touch = e.changedTouches[0];\n            _this.handleMouseUp(getPositionInfoFromTouch(touch, e));\n        };\n        return _this;\n    }\n    MouseWidget.prototype.setMouseDelay = function (mouseDelay) {\n        this.mouseDelay = mouseDelay;\n    };\n    MouseWidget.prototype.init = function () {\n        var element = this.$el.get(0);\n        element.addEventListener(\"mousedown\", this.mouseDown, {\n            passive: false\n        });\n        element.addEventListener(\"touchstart\", this.touchStart, {\n            passive: false\n        });\n        this.isMouseStarted = false;\n        this.mouseDelay = 0;\n        this.mouseDelayTimer = null;\n        this.isMouseDelayMet = false;\n        this.mouseDownInfo = null;\n    };\n    MouseWidget.prototype.deinit = function () {\n        var el = this.$el.get(0);\n        el.removeEventListener(\"mousedown\", this.mouseDown);\n        el.removeEventListener(\"touchstart\", this.touchStart);\n        document.removeEventListener(\"mousemove\", this.mouseMove);\n        document.removeEventListener(\"touchmove\", this.touchMove);\n        document.removeEventListener(\"mouseup\", this.mouseUp);\n        document.removeEventListener(\"touchend\", this.touchEnd);\n    };\n    MouseWidget.prototype.handleMouseDown = function (positionInfo) {\n        // We may have missed mouseup (out of window)\n        if (this.isMouseStarted) {\n            this.handleMouseUp(positionInfo);\n        }\n        this.mouseDownInfo = positionInfo;\n        if (!this.mouseCapture(positionInfo)) {\n            return false;\n        }\n        this.handleStartMouse();\n        return true;\n    };\n    MouseWidget.prototype.handleStartMouse = function () {\n        document.addEventListener(\"mousemove\", this.mouseMove, {\n            passive: false\n        });\n        document.addEventListener(\"touchmove\", this.touchMove, {\n            passive: false\n        });\n        document.addEventListener(\"mouseup\", this.mouseUp, { passive: false });\n        document.addEventListener(\"touchend\", this.touchEnd, {\n            passive: false\n        });\n        if (this.mouseDelay) {\n            this.startMouseDelayTimer();\n        }\n    };\n    MouseWidget.prototype.startMouseDelayTimer = function () {\n        var _this = this;\n        if (this.mouseDelayTimer) {\n            clearTimeout(this.mouseDelayTimer);\n        }\n        this.mouseDelayTimer = window.setTimeout(function () {\n            _this.isMouseDelayMet = true;\n        }, this.mouseDelay);\n        this.isMouseDelayMet = false;\n    };\n    MouseWidget.prototype.handleMouseMove = function (e, positionInfo) {\n        if (this.isMouseStarted) {\n            this.mouseDrag(positionInfo);\n            if (e.cancelable) {\n                e.preventDefault();\n            }\n            return;\n        }\n        if (this.mouseDelay && !this.isMouseDelayMet) {\n            return;\n        }\n        if (this.mouseDownInfo) {\n            this.isMouseStarted = this.mouseStart(this.mouseDownInfo) !== false;\n        }\n        if (this.isMouseStarted) {\n            this.mouseDrag(positionInfo);\n            if (e.cancelable) {\n                e.preventDefault();\n            }\n        }\n        else {\n            this.handleMouseUp(positionInfo);\n        }\n    };\n    MouseWidget.prototype.handleMouseUp = function (positionInfo) {\n        document.removeEventListener(\"mousemove\", this.mouseMove);\n        document.removeEventListener(\"touchmove\", this.touchMove);\n        document.removeEventListener(\"mouseup\", this.mouseUp);\n        document.removeEventListener(\"touchend\", this.touchEnd);\n        if (this.isMouseStarted) {\n            this.isMouseStarted = false;\n            this.mouseStop(positionInfo);\n        }\n    };\n    return MouseWidget;\n}(simple_widget_1[\"default\"]));\nexports[\"default\"] = MouseWidget;\n","\"use strict\";\nexports.__esModule = true;\nexports.Node = exports.getPosition = exports.getPositionName = exports.Position = void 0;\nvar Position;\n(function (Position) {\n    Position[Position[\"Before\"] = 1] = \"Before\";\n    Position[Position[\"After\"] = 2] = \"After\";\n    Position[Position[\"Inside\"] = 3] = \"Inside\";\n    Position[Position[\"None\"] = 4] = \"None\";\n})(Position = exports.Position || (exports.Position = {}));\nvar positionNames = {\n    before: Position.Before,\n    after: Position.After,\n    inside: Position.Inside,\n    none: Position.None\n};\nexports.getPositionName = function (position) {\n    for (var name_1 in positionNames) {\n        if (Object.prototype.hasOwnProperty.call(positionNames, name_1)) {\n            if (positionNames[name_1] === position) {\n                return name_1;\n            }\n        }\n    }\n    return \"\";\n};\nexports.getPosition = function (name) {\n    return positionNames[name];\n};\nvar Node = /** @class */ (function () {\n    function Node(o, isRoot, nodeClass) {\n        if (o === void 0) { o = null; }\n        if (isRoot === void 0) { isRoot = false; }\n        if (nodeClass === void 0) { nodeClass = Node; }\n        this.name = \"\";\n        this.isEmptyFolder = false;\n        this.load_on_demand = false;\n        this.setData(o);\n        this.children = [];\n        this.parent = null;\n        if (isRoot) {\n            this.idMapping = {};\n            this.tree = this;\n            this.nodeClass = nodeClass;\n        }\n    }\n    /*\n    Set the data of this node.\n\n    setData(string): set the name of the node\n    setdata(object): set attributes of the node\n\n    Examples:\n        setdata('node1')\n\n        setData({ name: 'node1', id: 1});\n\n        setData({ name: 'node2', id: 2, color: 'green'});\n\n    * This is an internal function; it is not in the docs\n    * Does not remove existing node values\n    */\n    Node.prototype.setData = function (o) {\n        if (!o) {\n            return;\n        }\n        else if (typeof o === \"string\") {\n            this.name = o;\n        }\n        else if (typeof o === \"object\") {\n            for (var key in o) {\n                if (Object.prototype.hasOwnProperty.call(o, key)) {\n                    var value = o[key];\n                    if (key === \"label\" || key === \"name\") {\n                        // You can use the 'label' key instead of 'name'; this is a legacy feature\n                        if (typeof value === \"string\") {\n                            this.name = value;\n                        }\n                    }\n                    else if (key !== \"children\" && key !== \"parent\") {\n                        // You can't update the children or the parent using this function\n                        this[key] = value;\n                    }\n                }\n            }\n        }\n    };\n    /*\n    Create tree from data.\n\n    Structure of data is:\n    [\n        {\n            name: 'node1',\n            children: [\n                { name: 'child1' },\n                { name: 'child2' }\n            ]\n        },\n        {\n            name: 'node2'\n        }\n    ]\n    */\n    Node.prototype.loadFromData = function (data) {\n        this.removeChildren();\n        for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\n            var o = data_1[_i];\n            var node = this.createNode(o);\n            this.addChild(node);\n            if (typeof o === \"object\" &&\n                o[\"children\"] &&\n                o[\"children\"] instanceof Array) {\n                if (o[\"children\"].length === 0) {\n                    node.isEmptyFolder = true;\n                }\n                else {\n                    node.loadFromData(o[\"children\"]);\n                }\n            }\n        }\n        return this;\n    };\n    /*\n    Add child.\n\n    tree.addChild(\n        new Node('child1')\n    );\n    */\n    Node.prototype.addChild = function (node) {\n        this.children.push(node);\n        node.setParent(this);\n    };\n    /*\n    Add child at position. Index starts at 0.\n\n    tree.addChildAtPosition(\n        new Node('abc'),\n        1\n    );\n    */\n    Node.prototype.addChildAtPosition = function (node, index) {\n        this.children.splice(index, 0, node);\n        node.setParent(this);\n    };\n    /*\n    Remove child. This also removes the children of the node.\n\n    tree.removeChild(tree.children[0]);\n    */\n    Node.prototype.removeChild = function (node) {\n        // remove children from the index\n        node.removeChildren();\n        this.doRemoveChild(node);\n    };\n    /*\n    Get child index.\n\n    var index = getChildIndex(node);\n    */\n    Node.prototype.getChildIndex = function (node) {\n        return jQuery.inArray(node, this.children);\n    };\n    /*\n    Does the tree have children?\n\n    if (tree.hasChildren()) {\n        //\n    }\n    */\n    Node.prototype.hasChildren = function () {\n        return this.children.length !== 0;\n    };\n    Node.prototype.isFolder = function () {\n        return this.hasChildren() || this.load_on_demand;\n    };\n    /*\n    Iterate over all the nodes in the tree.\n\n    Calls callback with (node, level).\n\n    The callback must return true to continue the iteration on current node.\n\n    tree.iterate(\n        function(node, level) {\n           console.log(node.name);\n\n           // stop iteration after level 2\n           return (level <= 2);\n        }\n    );\n\n    */\n    Node.prototype.iterate = function (callback) {\n        var _iterate = function (node, level) {\n            if (node.children) {\n                for (var _i = 0, _a = node.children; _i < _a.length; _i++) {\n                    var child = _a[_i];\n                    var result = callback(child, level);\n                    if (result && child.hasChildren()) {\n                        _iterate(child, level + 1);\n                    }\n                }\n            }\n        };\n        _iterate(this, 0);\n    };\n    /*\n    Move node relative to another node.\n\n    Argument position: Position.BEFORE, Position.AFTER or Position.Inside\n\n    // move node1 after node2\n    tree.moveNode(node1, node2, Position.AFTER);\n    */\n    Node.prototype.moveNode = function (movedNode, targetNode, position) {\n        if (!movedNode.parent || movedNode.isParentOf(targetNode)) {\n            // - Node is parent of target node\n            // - Or, parent is empty\n            return false;\n        }\n        else {\n            movedNode.parent.doRemoveChild(movedNode);\n            switch (position) {\n                case Position.After: {\n                    if (targetNode.parent) {\n                        targetNode.parent.addChildAtPosition(movedNode, targetNode.parent.getChildIndex(targetNode) + 1);\n                        return true;\n                    }\n                    return false;\n                }\n                case Position.Before: {\n                    if (targetNode.parent) {\n                        targetNode.parent.addChildAtPosition(movedNode, targetNode.parent.getChildIndex(targetNode));\n                        return true;\n                    }\n                    return false;\n                }\n                case Position.Inside: {\n                    // move inside as first child\n                    targetNode.addChildAtPosition(movedNode, 0);\n                    return true;\n                }\n                default:\n                    return false;\n            }\n        }\n    };\n    /*\n    Get the tree as data.\n    */\n    Node.prototype.getData = function (includeParent) {\n        if (includeParent === void 0) { includeParent = false; }\n        var getDataFromNodes = function (nodes) {\n            return nodes.map(function (node) {\n                var tmpNode = {};\n                for (var k in node) {\n                    if ([\n                        \"parent\",\n                        \"children\",\n                        \"element\",\n                        \"idMapping\",\n                        \"load_on_demand\",\n                        \"nodeClass\",\n                        \"tree\",\n                        \"isEmptyFolder\",\n                    ].indexOf(k) === -1 &&\n                        Object.prototype.hasOwnProperty.call(node, k)) {\n                        var v = node[k];\n                        tmpNode[k] = v;\n                    }\n                }\n                if (node.hasChildren()) {\n                    tmpNode[\"children\"] = getDataFromNodes(node.children);\n                }\n                return tmpNode;\n            });\n        };\n        if (includeParent) {\n            return getDataFromNodes([this]);\n        }\n        else {\n            return getDataFromNodes(this.children);\n        }\n    };\n    Node.prototype.getNodeByName = function (name) {\n        return this.getNodeByCallback(function (node) { return node.name === name; });\n    };\n    Node.prototype.getNodeByNameMustExist = function (name) {\n        var node = this.getNodeByCallback(function (n) { return n.name === name; });\n        if (!node) {\n            throw \"Node with name \" + name + \" not found\";\n        }\n        return node;\n    };\n    Node.prototype.getNodeByCallback = function (callback) {\n        var result = null;\n        this.iterate(function (node) {\n            if (result) {\n                return false;\n            }\n            else if (callback(node)) {\n                result = node;\n                return false;\n            }\n            else {\n                return true;\n            }\n        });\n        return result;\n    };\n    Node.prototype.addAfter = function (nodeInfo) {\n        if (!this.parent) {\n            return null;\n        }\n        else {\n            var node = this.createNode(nodeInfo);\n            var childIndex = this.parent.getChildIndex(this);\n            this.parent.addChildAtPosition(node, childIndex + 1);\n            if (typeof nodeInfo === \"object\" &&\n                nodeInfo[\"children\"] &&\n                nodeInfo[\"children\"] instanceof Array &&\n                nodeInfo[\"children\"].length) {\n                node.loadFromData(nodeInfo[\"children\"]);\n            }\n            return node;\n        }\n    };\n    Node.prototype.addBefore = function (nodeInfo) {\n        if (!this.parent) {\n            return null;\n        }\n        else {\n            var node = this.createNode(nodeInfo);\n            var childIndex = this.parent.getChildIndex(this);\n            this.parent.addChildAtPosition(node, childIndex);\n            if (typeof nodeInfo === \"object\" &&\n                nodeInfo[\"children\"] &&\n                nodeInfo[\"children\"] instanceof Array &&\n                nodeInfo[\"children\"].length) {\n                node.loadFromData(nodeInfo[\"children\"]);\n            }\n            return node;\n        }\n    };\n    Node.prototype.addParent = function (nodeInfo) {\n        if (!this.parent) {\n            return null;\n        }\n        else {\n            var newParent = this.createNode(nodeInfo);\n            if (this.tree) {\n                newParent.setParent(this.tree);\n            }\n            var originalParent = this.parent;\n            for (var _i = 0, _a = originalParent.children; _i < _a.length; _i++) {\n                var child = _a[_i];\n                newParent.addChild(child);\n            }\n            originalParent.children = [];\n            originalParent.addChild(newParent);\n            return newParent;\n        }\n    };\n    Node.prototype.remove = function () {\n        if (this.parent) {\n            this.parent.removeChild(this);\n            this.parent = null;\n        }\n    };\n    Node.prototype.append = function (nodeInfo) {\n        var node = this.createNode(nodeInfo);\n        this.addChild(node);\n        if (typeof nodeInfo === \"object\" &&\n            nodeInfo[\"children\"] &&\n            nodeInfo[\"children\"] instanceof Array &&\n            nodeInfo[\"children\"].length) {\n            node.loadFromData(nodeInfo[\"children\"]);\n        }\n        return node;\n    };\n    Node.prototype.prepend = function (nodeInfo) {\n        var node = this.createNode(nodeInfo);\n        this.addChildAtPosition(node, 0);\n        if (typeof nodeInfo === \"object\" &&\n            nodeInfo[\"children\"] &&\n            nodeInfo[\"children\"] instanceof Array &&\n            nodeInfo[\"children\"].length) {\n            node.loadFromData(nodeInfo[\"children\"]);\n        }\n        return node;\n    };\n    Node.prototype.isParentOf = function (node) {\n        var parent = node.parent;\n        while (parent) {\n            if (parent === this) {\n                return true;\n            }\n            parent = parent.parent;\n        }\n        return false;\n    };\n    Node.prototype.getLevel = function () {\n        var level = 0;\n        var node = this; // eslint-disable-line @typescript-eslint/no-this-alias\n        while (node.parent) {\n            level += 1;\n            node = node.parent;\n        }\n        return level;\n    };\n    Node.prototype.getNodeById = function (nodeId) {\n        return this.idMapping[nodeId] || null;\n    };\n    Node.prototype.addNodeToIndex = function (node) {\n        if (node.id != null) {\n            this.idMapping[node.id] = node;\n        }\n    };\n    Node.prototype.removeNodeFromIndex = function (node) {\n        if (node.id != null) {\n            delete this.idMapping[node.id];\n        }\n    };\n    Node.prototype.removeChildren = function () {\n        var _this = this;\n        this.iterate(function (child) {\n            var _a;\n            (_a = _this.tree) === null || _a === void 0 ? void 0 : _a.removeNodeFromIndex(child);\n            return true;\n        });\n        this.children = [];\n    };\n    Node.prototype.getPreviousSibling = function () {\n        if (!this.parent) {\n            return null;\n        }\n        else {\n            var previousIndex = this.parent.getChildIndex(this) - 1;\n            if (previousIndex >= 0) {\n                return this.parent.children[previousIndex];\n            }\n            else {\n                return null;\n            }\n        }\n    };\n    Node.prototype.getNextSibling = function () {\n        if (!this.parent) {\n            return null;\n        }\n        else {\n            var nextIndex = this.parent.getChildIndex(this) + 1;\n            if (nextIndex < this.parent.children.length) {\n                return this.parent.children[nextIndex];\n            }\n            else {\n                return null;\n            }\n        }\n    };\n    Node.prototype.getNodesByProperty = function (key, value) {\n        return this.filter(function (node) { return node[key] === value; });\n    };\n    Node.prototype.filter = function (f) {\n        var result = [];\n        this.iterate(function (node) {\n            if (f(node)) {\n                result.push(node);\n            }\n            return true;\n        });\n        return result;\n    };\n    Node.prototype.getNextNode = function (includeChildren) {\n        if (includeChildren === void 0) { includeChildren = true; }\n        if (includeChildren && this.hasChildren() && this.is_open) {\n            // First child\n            return this.children[0];\n        }\n        else {\n            if (!this.parent) {\n                return null;\n            }\n            else {\n                var nextSibling = this.getNextSibling();\n                if (nextSibling) {\n                    // Next sibling\n                    return nextSibling;\n                }\n                else {\n                    // Next node of parent\n                    return this.parent.getNextNode(false);\n                }\n            }\n        }\n    };\n    Node.prototype.getPreviousNode = function () {\n        if (!this.parent) {\n            return null;\n        }\n        else {\n            var previousSibling = this.getPreviousSibling();\n            if (previousSibling) {\n                if (!previousSibling.hasChildren() ||\n                    !previousSibling.is_open) {\n                    // Previous sibling\n                    return previousSibling;\n                }\n                else {\n                    // Last child of previous sibling\n                    return previousSibling.getLastChild();\n                }\n            }\n            else {\n                return this.getParent();\n            }\n        }\n    };\n    Node.prototype.getParent = function () {\n        // Return parent except if it is the root node\n        if (!this.parent) {\n            return null;\n        }\n        else if (!this.parent.parent) {\n            // Root node -> null\n            return null;\n        }\n        else {\n            return this.parent;\n        }\n    };\n    Node.prototype.getLastChild = function () {\n        if (!this.hasChildren()) {\n            return null;\n        }\n        else {\n            var lastChild = this.children[this.children.length - 1];\n            if (!(lastChild.hasChildren() && lastChild.is_open)) {\n                return lastChild;\n            }\n            else {\n                return lastChild.getLastChild();\n            }\n        }\n    };\n    // Init Node from data without making it the root of the tree\n    Node.prototype.initFromData = function (data) {\n        var _this = this;\n        var addNode = function (nodeData) {\n            _this.setData(nodeData);\n            if (typeof nodeData === \"object\" &&\n                nodeData[\"children\"] &&\n                nodeData[\"children\"] instanceof Array &&\n                nodeData[\"children\"].length) {\n                addChildren(nodeData[\"children\"]);\n            }\n        };\n        var addChildren = function (childrenData) {\n            for (var _i = 0, childrenData_1 = childrenData; _i < childrenData_1.length; _i++) {\n                var child = childrenData_1[_i];\n                var node = _this.createNode();\n                node.initFromData(child);\n                _this.addChild(node);\n            }\n        };\n        addNode(data);\n    };\n    Node.prototype.setParent = function (parent) {\n        var _a;\n        this.parent = parent;\n        this.tree = parent.tree;\n        (_a = this.tree) === null || _a === void 0 ? void 0 : _a.addNodeToIndex(this);\n    };\n    Node.prototype.doRemoveChild = function (node) {\n        var _a;\n        this.children.splice(this.getChildIndex(node), 1);\n        (_a = this.tree) === null || _a === void 0 ? void 0 : _a.removeNodeFromIndex(node);\n    };\n    Node.prototype.getNodeClass = function () {\n        var _a;\n        return this.nodeClass || ((_a = this === null || this === void 0 ? void 0 : this.tree) === null || _a === void 0 ? void 0 : _a.nodeClass) || Node;\n    };\n    Node.prototype.createNode = function (nodeData) {\n        var nodeClass = this.getNodeClass();\n        return new nodeClass(nodeData);\n    };\n    return Node;\n}());\nexports.Node = Node;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nexports.__esModule = true;\nexports.BorderDropHint = exports.FolderElement = exports.NodeElement = void 0;\nvar node_1 = require(\"./node\");\nvar NodeElement = /** @class */ (function () {\n    function NodeElement(node, treeWidget) {\n        this.init(node, treeWidget);\n    }\n    NodeElement.prototype.init = function (node, treeWidget) {\n        this.node = node;\n        this.treeWidget = treeWidget;\n        if (!node.element) {\n            node.element = this.treeWidget.element.get(0);\n        }\n        this.$element = jQuery(node.element);\n    };\n    NodeElement.prototype.addDropHint = function (position) {\n        if (this.mustShowBorderDropHint(position)) {\n            return new BorderDropHint(this.$element, this.treeWidget._getScrollLeft());\n        }\n        else {\n            return new GhostDropHint(this.node, this.$element, position);\n        }\n    };\n    NodeElement.prototype.select = function (mustSetFocus) {\n        var _a;\n        var $li = this.getLi();\n        $li.addClass(\"jqtree-selected\");\n        $li.attr(\"aria-selected\", \"true\");\n        var $span = this.getSpan();\n        $span.attr(\"tabindex\", (_a = this.treeWidget.options.tabIndex) !== null && _a !== void 0 ? _a : null);\n        if (mustSetFocus) {\n            $span.focus();\n        }\n    };\n    NodeElement.prototype.deselect = function () {\n        var $li = this.getLi();\n        $li.removeClass(\"jqtree-selected\");\n        $li.attr(\"aria-selected\", \"false\");\n        var $span = this.getSpan();\n        $span.removeAttr(\"tabindex\");\n        $span.blur();\n    };\n    NodeElement.prototype.getUl = function () {\n        return this.$element.children(\"ul:first\");\n    };\n    NodeElement.prototype.getSpan = function () {\n        return this.$element\n            .children(\".jqtree-element\")\n            .find(\"span.jqtree-title\");\n    };\n    NodeElement.prototype.getLi = function () {\n        return this.$element;\n    };\n    NodeElement.prototype.mustShowBorderDropHint = function (position) {\n        return position === node_1.Position.Inside;\n    };\n    return NodeElement;\n}());\nexports.NodeElement = NodeElement;\nvar FolderElement = /** @class */ (function (_super) {\n    __extends(FolderElement, _super);\n    function FolderElement() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FolderElement.prototype.open = function (onFinished, slide, animationSpeed) {\n        var _this = this;\n        if (slide === void 0) { slide = true; }\n        if (animationSpeed === void 0) { animationSpeed = \"fast\"; }\n        if (this.node.is_open) {\n            return;\n        }\n        this.node.is_open = true;\n        var $button = this.getButton();\n        $button.removeClass(\"jqtree-closed\");\n        $button.html(\"\");\n        var buttonEl = $button.get(0);\n        if (buttonEl) {\n            var icon = this.treeWidget.renderer.openedIconElement.cloneNode(true);\n            buttonEl.appendChild(icon);\n        }\n        var doOpen = function () {\n            var $li = _this.getLi();\n            $li.removeClass(\"jqtree-closed\");\n            var $span = _this.getSpan();\n            $span.attr(\"aria-expanded\", \"true\");\n            if (onFinished) {\n                onFinished(_this.node);\n            }\n            _this.treeWidget._triggerEvent(\"tree.open\", {\n                node: _this.node\n            });\n        };\n        if (slide) {\n            this.getUl().slideDown(animationSpeed, doOpen);\n        }\n        else {\n            this.getUl().show();\n            doOpen();\n        }\n    };\n    FolderElement.prototype.close = function (slide, animationSpeed) {\n        var _this = this;\n        if (slide === void 0) { slide = true; }\n        if (animationSpeed === void 0) { animationSpeed = \"fast\"; }\n        if (!this.node.is_open) {\n            return;\n        }\n        this.node.is_open = false;\n        var $button = this.getButton();\n        $button.addClass(\"jqtree-closed\");\n        $button.html(\"\");\n        var buttonEl = $button.get(0);\n        if (buttonEl) {\n            var icon = this.treeWidget.renderer.closedIconElement.cloneNode(true);\n            buttonEl.appendChild(icon);\n        }\n        var doClose = function () {\n            var $li = _this.getLi();\n            $li.addClass(\"jqtree-closed\");\n            var $span = _this.getSpan();\n            $span.attr(\"aria-expanded\", \"false\");\n            _this.treeWidget._triggerEvent(\"tree.close\", {\n                node: _this.node\n            });\n        };\n        if (slide) {\n            this.getUl().slideUp(animationSpeed, doClose);\n        }\n        else {\n            this.getUl().hide();\n            doClose();\n        }\n    };\n    FolderElement.prototype.mustShowBorderDropHint = function (position) {\n        return !this.node.is_open && position === node_1.Position.Inside;\n    };\n    FolderElement.prototype.getButton = function () {\n        return this.$element\n            .children(\".jqtree-element\")\n            .find(\"a.jqtree-toggler\");\n    };\n    return FolderElement;\n}(NodeElement));\nexports.FolderElement = FolderElement;\nvar BorderDropHint = /** @class */ (function () {\n    function BorderDropHint($element, scrollLeft) {\n        var $div = $element.children(\".jqtree-element\");\n        var elWidth = $element.width() || 0;\n        var width = Math.max(elWidth + scrollLeft - 4, 0);\n        var elHeight = $div.outerHeight() || 0;\n        var height = Math.max(elHeight - 4, 0);\n        this.$hint = jQuery('<span class=\"jqtree-border\"></span>');\n        $div.append(this.$hint);\n        this.$hint.css({ width: width, height: height });\n    }\n    BorderDropHint.prototype.remove = function () {\n        this.$hint.remove();\n    };\n    return BorderDropHint;\n}());\nexports.BorderDropHint = BorderDropHint;\nvar GhostDropHint = /** @class */ (function () {\n    function GhostDropHint(node, $element, position) {\n        this.$element = $element;\n        this.node = node;\n        this.$ghost = jQuery(\"<li class=\\\"jqtree_common jqtree-ghost\\\"><span class=\\\"jqtree_common jqtree-circle\\\"></span>\\n            <span class=\\\"jqtree_common jqtree-line\\\"></span></li>\");\n        if (position === node_1.Position.After) {\n            this.moveAfter();\n        }\n        else if (position === node_1.Position.Before) {\n            this.moveBefore();\n        }\n        else if (position === node_1.Position.Inside) {\n            if (node.isFolder() && node.is_open) {\n                this.moveInsideOpenFolder();\n            }\n            else {\n                this.moveInside();\n            }\n        }\n    }\n    GhostDropHint.prototype.remove = function () {\n        this.$ghost.remove();\n    };\n    GhostDropHint.prototype.moveAfter = function () {\n        this.$element.after(this.$ghost);\n    };\n    GhostDropHint.prototype.moveBefore = function () {\n        this.$element.before(this.$ghost);\n    };\n    GhostDropHint.prototype.moveInsideOpenFolder = function () {\n        jQuery(this.node.children[0].element).before(this.$ghost);\n    };\n    GhostDropHint.prototype.moveInside = function () {\n        this.$element.after(this.$ghost);\n        this.$ghost.addClass(\"jqtree-inside\");\n    };\n    return GhostDropHint;\n}());\n","\"use strict\";\nexports.__esModule = true;\nvar util_1 = require(\"./util\");\nvar SaveStateHandler = /** @class */ (function () {\n    function SaveStateHandler(treeWidget) {\n        this.treeWidget = treeWidget;\n    }\n    SaveStateHandler.prototype.saveState = function () {\n        var state = JSON.stringify(this.getState());\n        if (this.treeWidget.options.onSetStateFromStorage) {\n            this.treeWidget.options.onSetStateFromStorage(state);\n        }\n        else if (this.supportsLocalStorage()) {\n            localStorage.setItem(this.getKeyName(), state);\n        }\n    };\n    SaveStateHandler.prototype.getStateFromStorage = function () {\n        var jsonData = this.loadFromStorage();\n        if (jsonData) {\n            return this.parseState(jsonData);\n        }\n        else {\n            return null;\n        }\n    };\n    SaveStateHandler.prototype.getState = function () {\n        var _this = this;\n        var getOpenNodeIds = function () {\n            var openNodes = [];\n            _this.treeWidget.tree.iterate(function (node) {\n                if (node.is_open && node.id && node.hasChildren()) {\n                    openNodes.push(node.id);\n                }\n                return true;\n            });\n            return openNodes;\n        };\n        var getSelectedNodeIds = function () {\n            var selectedNodeIds = [];\n            _this.treeWidget.getSelectedNodes().forEach(function (node) {\n                if (node.id != null) {\n                    selectedNodeIds.push(node.id);\n                }\n            });\n            return selectedNodeIds;\n        };\n        return {\n            open_nodes: getOpenNodeIds(),\n            selected_node: getSelectedNodeIds()\n        };\n    };\n    /*\n    Set initial state\n    Don't handle nodes that are loaded on demand\n\n    result: must load on demand\n    */\n    SaveStateHandler.prototype.setInitialState = function (state) {\n        if (!state) {\n            return false;\n        }\n        else {\n            var mustLoadOnDemand = false;\n            if (state.open_nodes) {\n                mustLoadOnDemand = this.openInitialNodes(state.open_nodes);\n            }\n            if (state.selected_node) {\n                this.resetSelection();\n                this.selectInitialNodes(state.selected_node);\n            }\n            return mustLoadOnDemand;\n        }\n    };\n    SaveStateHandler.prototype.setInitialStateOnDemand = function (state, cbFinished) {\n        if (state) {\n            this.doSetInitialStateOnDemand(state.open_nodes, state.selected_node, cbFinished);\n        }\n        else {\n            cbFinished();\n        }\n    };\n    SaveStateHandler.prototype.getNodeIdToBeSelected = function () {\n        var state = this.getStateFromStorage();\n        if (state && state.selected_node) {\n            return state.selected_node[0];\n        }\n        else {\n            return null;\n        }\n    };\n    SaveStateHandler.prototype.parseState = function (jsonData) {\n        var state = jQuery.parseJSON(jsonData);\n        // Check if selected_node is an int (instead of an array)\n        if (state && state.selected_node && util_1.isInt(state.selected_node)) {\n            // Convert to array\n            state.selected_node = [state.selected_node];\n        }\n        return state;\n    };\n    SaveStateHandler.prototype.loadFromStorage = function () {\n        if (this.treeWidget.options.onGetStateFromStorage) {\n            return this.treeWidget.options.onGetStateFromStorage();\n        }\n        else if (this.supportsLocalStorage()) {\n            return localStorage.getItem(this.getKeyName());\n        }\n        else {\n            return null;\n        }\n    };\n    SaveStateHandler.prototype.openInitialNodes = function (nodeIds) {\n        var mustLoadOnDemand = false;\n        for (var _i = 0, nodeIds_1 = nodeIds; _i < nodeIds_1.length; _i++) {\n            var nodeDd = nodeIds_1[_i];\n            var node = this.treeWidget.getNodeById(nodeDd);\n            if (node) {\n                if (!node.load_on_demand) {\n                    node.is_open = true;\n                }\n                else {\n                    mustLoadOnDemand = true;\n                }\n            }\n        }\n        return mustLoadOnDemand;\n    };\n    SaveStateHandler.prototype.selectInitialNodes = function (nodeIds) {\n        var selectCount = 0;\n        for (var _i = 0, nodeIds_2 = nodeIds; _i < nodeIds_2.length; _i++) {\n            var nodeId = nodeIds_2[_i];\n            var node = this.treeWidget.getNodeById(nodeId);\n            if (node) {\n                selectCount += 1;\n                this.treeWidget.selectNodeHandler.addToSelection(node);\n            }\n        }\n        return selectCount !== 0;\n    };\n    SaveStateHandler.prototype.resetSelection = function () {\n        var selectNodeHandler = this.treeWidget.selectNodeHandler;\n        var selectedNodes = selectNodeHandler.getSelectedNodes();\n        selectedNodes.forEach(function (node) {\n            selectNodeHandler.removeFromSelection(node);\n        });\n    };\n    SaveStateHandler.prototype.doSetInitialStateOnDemand = function (nodeIdsParam, selectedNodes, cbFinished) {\n        var _this = this;\n        var loadingCount = 0;\n        var nodeIds = nodeIdsParam;\n        var openNodes = function () {\n            var newNodesIds = [];\n            for (var _i = 0, nodeIds_3 = nodeIds; _i < nodeIds_3.length; _i++) {\n                var nodeId = nodeIds_3[_i];\n                var node = _this.treeWidget.getNodeById(nodeId);\n                if (!node) {\n                    newNodesIds.push(nodeId);\n                }\n                else {\n                    if (!node.is_loading) {\n                        if (node.load_on_demand) {\n                            loadAndOpenNode(node);\n                        }\n                        else {\n                            _this.treeWidget._openNode(node, false, null);\n                        }\n                    }\n                }\n            }\n            nodeIds = newNodesIds;\n            if (_this.selectInitialNodes(selectedNodes)) {\n                _this.treeWidget._refreshElements(null);\n            }\n            if (loadingCount === 0) {\n                cbFinished();\n            }\n        };\n        var loadAndOpenNode = function (node) {\n            loadingCount += 1;\n            _this.treeWidget._openNode(node, false, function () {\n                loadingCount -= 1;\n                openNodes();\n            });\n        };\n        openNodes();\n    };\n    SaveStateHandler.prototype.getKeyName = function () {\n        if (typeof this.treeWidget.options.saveState === \"string\") {\n            return this.treeWidget.options.saveState;\n        }\n        else {\n            return \"tree\";\n        }\n    };\n    SaveStateHandler.prototype.supportsLocalStorage = function () {\n        var testSupport = function () {\n            // Is local storage supported?\n            if (localStorage == null) {\n                return false;\n            }\n            else {\n                // Check if it's possible to store an item. Safari does not allow this in private browsing mode.\n                try {\n                    var key = \"_storage_test\";\n                    sessionStorage.setItem(key, \"value\");\n                    sessionStorage.removeItem(key);\n                }\n                catch (error) {\n                    return false;\n                }\n                return true;\n            }\n        };\n        if (this._supportsLocalStorage == null) {\n            this._supportsLocalStorage = testSupport();\n        }\n        return this._supportsLocalStorage;\n    };\n    return SaveStateHandler;\n}());\nexports[\"default\"] = SaveStateHandler;\n","\"use strict\";\nexports.__esModule = true;\nvar ScrollHandler = /** @class */ (function () {\n    function ScrollHandler(treeWidget) {\n        this.treeWidget = treeWidget;\n        this.previousTop = -1;\n        this.isInitialized = false;\n    }\n    ScrollHandler.prototype.checkScrolling = function () {\n        this.ensureInit();\n        this.checkVerticalScrolling();\n        this.checkHorizontalScrolling();\n    };\n    ScrollHandler.prototype.scrollToY = function (top) {\n        this.ensureInit();\n        if (this.$scrollParent) {\n            this.$scrollParent[0].scrollTop = top;\n        }\n        else {\n            var offset = this.treeWidget.$el.offset();\n            var treeTop = offset ? offset.top : 0;\n            jQuery(document).scrollTop(top + treeTop);\n        }\n    };\n    ScrollHandler.prototype.isScrolledIntoView = function ($element) {\n        this.ensureInit();\n        var elementBottom;\n        var viewBottom;\n        var elementTop;\n        var viewTop;\n        var elHeight = $element.height() || 0;\n        if (this.$scrollParent) {\n            viewTop = 0;\n            viewBottom = this.$scrollParent.height() || 0;\n            var offset = $element.offset();\n            var originalTop = offset ? offset.top : 0;\n            elementTop = originalTop - this.scrollParentTop;\n            elementBottom = elementTop + elHeight;\n        }\n        else {\n            viewTop = jQuery(window).scrollTop() || 0;\n            var windowHeight = jQuery(window).height() || 0;\n            viewBottom = viewTop + windowHeight;\n            var offset = $element.offset();\n            elementTop = offset ? offset.top : 0;\n            elementBottom = elementTop + elHeight;\n        }\n        return elementBottom <= viewBottom && elementTop >= viewTop;\n    };\n    ScrollHandler.prototype.getScrollLeft = function () {\n        if (!this.$scrollParent) {\n            return 0;\n        }\n        else {\n            return this.$scrollParent.scrollLeft() || 0;\n        }\n    };\n    ScrollHandler.prototype.initScrollParent = function () {\n        var _this = this;\n        var getParentWithOverflow = function () {\n            var cssAttributes = [\"overflow\", \"overflow-y\"];\n            var hasOverFlow = function ($el) {\n                for (var _i = 0, cssAttributes_1 = cssAttributes; _i < cssAttributes_1.length; _i++) {\n                    var attr = cssAttributes_1[_i];\n                    var overflowValue = $el.css(attr);\n                    if (overflowValue === \"auto\" ||\n                        overflowValue === \"scroll\") {\n                        return true;\n                    }\n                }\n                return false;\n            };\n            if (hasOverFlow(_this.treeWidget.$el)) {\n                return _this.treeWidget.$el;\n            }\n            for (var _i = 0, _a = _this.treeWidget.$el.parents().get(); _i < _a.length; _i++) {\n                var el = _a[_i];\n                var $el = jQuery(el);\n                if (hasOverFlow($el)) {\n                    return $el;\n                }\n            }\n            return null;\n        };\n        var setDocumentAsScrollParent = function () {\n            _this.scrollParentTop = 0;\n            _this.$scrollParent = null;\n        };\n        if (this.treeWidget.$el.css(\"position\") === \"fixed\") {\n            setDocumentAsScrollParent();\n        }\n        var $scrollParent = getParentWithOverflow();\n        if ($scrollParent &&\n            $scrollParent.length &&\n            $scrollParent[0].tagName !== \"HTML\") {\n            this.$scrollParent = $scrollParent;\n            var offset = this.$scrollParent.offset();\n            this.scrollParentTop = offset ? offset.top : 0;\n        }\n        else {\n            setDocumentAsScrollParent();\n        }\n        this.isInitialized = true;\n    };\n    ScrollHandler.prototype.ensureInit = function () {\n        if (!this.isInitialized) {\n            this.initScrollParent();\n        }\n    };\n    ScrollHandler.prototype.handleVerticalScrollingWithScrollParent = function (area) {\n        var scrollParent = this.$scrollParent && this.$scrollParent[0];\n        if (!scrollParent) {\n            return;\n        }\n        var distanceBottom = this.scrollParentTop + scrollParent.offsetHeight - area.bottom;\n        if (distanceBottom < 20) {\n            scrollParent.scrollTop += 20;\n            this.treeWidget.refreshHitAreas();\n            this.previousTop = -1;\n        }\n        else if (area.top - this.scrollParentTop < 20) {\n            scrollParent.scrollTop -= 20;\n            this.treeWidget.refreshHitAreas();\n            this.previousTop = -1;\n        }\n    };\n    ScrollHandler.prototype.handleVerticalScrollingWithDocument = function (area) {\n        var scrollTop = jQuery(document).scrollTop() || 0;\n        var distanceTop = area.top - scrollTop;\n        if (distanceTop < 20) {\n            jQuery(document).scrollTop(scrollTop - 20);\n        }\n        else {\n            var windowHeight = jQuery(window).height() || 0;\n            if (windowHeight - (area.bottom - scrollTop) < 20) {\n                jQuery(document).scrollTop(scrollTop + 20);\n            }\n        }\n    };\n    ScrollHandler.prototype.checkVerticalScrolling = function () {\n        var hoveredArea = this.treeWidget.dndHandler.hoveredArea;\n        if (hoveredArea && hoveredArea.top !== this.previousTop) {\n            this.previousTop = hoveredArea.top;\n            if (this.$scrollParent) {\n                this.handleVerticalScrollingWithScrollParent(hoveredArea);\n            }\n            else {\n                this.handleVerticalScrollingWithDocument(hoveredArea);\n            }\n        }\n    };\n    ScrollHandler.prototype.checkHorizontalScrolling = function () {\n        var positionInfo = this.treeWidget.dndHandler.positionInfo;\n        if (!positionInfo) {\n            return;\n        }\n        if (this.$scrollParent) {\n            this.handleHorizontalScrollingWithParent(positionInfo);\n        }\n        else {\n            this.handleHorizontalScrollingWithDocument(positionInfo);\n        }\n    };\n    ScrollHandler.prototype.handleHorizontalScrollingWithParent = function (positionInfo) {\n        if (positionInfo.pageX === undefined ||\n            positionInfo.pageY === undefined) {\n            return;\n        }\n        var $scrollParent = this.$scrollParent;\n        var scrollParentOffset = $scrollParent && $scrollParent.offset();\n        if (!($scrollParent && scrollParentOffset)) {\n            return;\n        }\n        var scrollParent = $scrollParent[0];\n        var canScrollRight = scrollParent.scrollLeft + scrollParent.clientWidth <\n            scrollParent.scrollWidth;\n        var canScrollLeft = scrollParent.scrollLeft > 0;\n        var rightEdge = scrollParentOffset.left + scrollParent.clientWidth;\n        var leftEdge = scrollParentOffset.left;\n        var isNearRightEdge = positionInfo.pageX > rightEdge - 20;\n        var isNearLeftEdge = positionInfo.pageX < leftEdge + 20;\n        if (isNearRightEdge && canScrollRight) {\n            scrollParent.scrollLeft = Math.min(scrollParent.scrollLeft + 20, scrollParent.scrollWidth);\n        }\n        else if (isNearLeftEdge && canScrollLeft) {\n            scrollParent.scrollLeft = Math.max(scrollParent.scrollLeft - 20, 0);\n        }\n    };\n    ScrollHandler.prototype.handleHorizontalScrollingWithDocument = function (positionInfo) {\n        if (positionInfo.pageX === undefined ||\n            positionInfo.pageY === undefined) {\n            return;\n        }\n        var $document = jQuery(document);\n        var scrollLeft = $document.scrollLeft() || 0;\n        var windowWidth = jQuery(window).width() || 0;\n        var canScrollLeft = scrollLeft > 0;\n        var isNearRightEdge = positionInfo.pageX > windowWidth - 20;\n        var isNearLeftEdge = positionInfo.pageX - scrollLeft < 20;\n        if (isNearRightEdge) {\n            $document.scrollLeft(scrollLeft + 20);\n        }\n        else if (isNearLeftEdge && canScrollLeft) {\n            $document.scrollLeft(Math.max(scrollLeft - 20, 0));\n        }\n    };\n    return ScrollHandler;\n}());\nexports[\"default\"] = ScrollHandler;\n","\"use strict\";\nexports.__esModule = true;\nvar SelectNodeHandler = /** @class */ (function () {\n    function SelectNodeHandler(treeWidget) {\n        this.treeWidget = treeWidget;\n        this.clear();\n    }\n    SelectNodeHandler.prototype.getSelectedNode = function () {\n        var selectedNodes = this.getSelectedNodes();\n        if (selectedNodes.length) {\n            return selectedNodes[0];\n        }\n        else {\n            return false;\n        }\n    };\n    SelectNodeHandler.prototype.getSelectedNodes = function () {\n        if (this.selectedSingleNode) {\n            return [this.selectedSingleNode];\n        }\n        else {\n            var selectedNodes = [];\n            for (var id in this.selectedNodes) {\n                if (Object.prototype.hasOwnProperty.call(this.selectedNodes, id)) {\n                    var node = this.treeWidget.getNodeById(id);\n                    if (node) {\n                        selectedNodes.push(node);\n                    }\n                }\n            }\n            return selectedNodes;\n        }\n    };\n    SelectNodeHandler.prototype.getSelectedNodesUnder = function (parent) {\n        if (this.selectedSingleNode) {\n            if (parent.isParentOf(this.selectedSingleNode)) {\n                return [this.selectedSingleNode];\n            }\n            else {\n                return [];\n            }\n        }\n        else {\n            var selectedNodes = [];\n            for (var id in this.selectedNodes) {\n                if (Object.prototype.hasOwnProperty.call(this.selectedNodes, id)) {\n                    var node = this.treeWidget.getNodeById(id);\n                    if (node && parent.isParentOf(node)) {\n                        selectedNodes.push(node);\n                    }\n                }\n            }\n            return selectedNodes;\n        }\n    };\n    SelectNodeHandler.prototype.isNodeSelected = function (node) {\n        if (node.id != null) {\n            if (this.selectedNodes[node.id]) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n        else if (this.selectedSingleNode) {\n            return this.selectedSingleNode.element === node.element;\n        }\n        else {\n            return false;\n        }\n    };\n    SelectNodeHandler.prototype.clear = function () {\n        this.selectedNodes = {};\n        this.selectedSingleNode = null;\n    };\n    SelectNodeHandler.prototype.removeFromSelection = function (node, includeChildren) {\n        var _this = this;\n        if (includeChildren === void 0) { includeChildren = false; }\n        if (node.id == null) {\n            if (this.selectedSingleNode &&\n                node.element === this.selectedSingleNode.element) {\n                this.selectedSingleNode = null;\n            }\n        }\n        else {\n            delete this.selectedNodes[node.id];\n            if (includeChildren) {\n                node.iterate(function () {\n                    if (node.id != null) {\n                        delete _this.selectedNodes[node.id];\n                    }\n                    return true;\n                });\n            }\n        }\n    };\n    SelectNodeHandler.prototype.addToSelection = function (node) {\n        if (node.id != null) {\n            this.selectedNodes[node.id] = true;\n        }\n        else {\n            this.selectedSingleNode = node;\n        }\n    };\n    return SelectNodeHandler;\n}());\nexports[\"default\"] = SelectNodeHandler;\n","\"use strict\";\nexports.__esModule = true;\nvar register = function (widgetClass, widgetName) {\n    var getDataKey = function () { return \"simple_widget_\" + widgetName; };\n    var getWidgetData = function (el, dataKey) {\n        var widget = jQuery.data(el, dataKey);\n        if (widget && widget instanceof SimpleWidget) {\n            return widget;\n        }\n        else {\n            return null;\n        }\n    };\n    var createWidget = function ($el, options) {\n        var dataKey = getDataKey();\n        for (var _i = 0, _a = $el.get(); _i < _a.length; _i++) {\n            var el = _a[_i];\n            var existingWidget = getWidgetData(el, dataKey);\n            if (!existingWidget) {\n                var simpleWidgetClass = widgetClass;\n                var widget = new simpleWidgetClass(el, options);\n                if (!jQuery.data(el, dataKey)) {\n                    jQuery.data(el, dataKey, widget);\n                }\n                // Call init after setting data, so we can call methods\n                widget.init();\n            }\n        }\n        return $el;\n    };\n    var destroyWidget = function ($el) {\n        var dataKey = getDataKey();\n        for (var _i = 0, _a = $el.get(); _i < _a.length; _i++) {\n            var el = _a[_i];\n            var widget = getWidgetData(el, dataKey);\n            if (widget) {\n                widget.destroy();\n            }\n            jQuery.removeData(el, dataKey);\n        }\n    };\n    var callFunction = function ($el, functionName, args) {\n        var result = null;\n        for (var _i = 0, _a = $el.get(); _i < _a.length; _i++) {\n            var el = _a[_i];\n            var widget = jQuery.data(el, getDataKey());\n            if (widget && widget instanceof SimpleWidget) {\n                var simpleWidget = widget;\n                var widgetFunction = simpleWidget[functionName];\n                if (widgetFunction && typeof widgetFunction === \"function\") {\n                    result = widgetFunction.apply(widget, args);\n                }\n            }\n        }\n        return result;\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    jQuery.fn[widgetName] = function (argument1) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        if (!argument1) {\n            return createWidget(this, null);\n        }\n        else if (typeof argument1 === \"object\") {\n            var options = argument1;\n            return createWidget(this, options);\n        }\n        else if (typeof argument1 === \"string\" && argument1[0] !== \"_\") {\n            var functionName = argument1;\n            if (functionName === \"destroy\") {\n                return destroyWidget(this);\n            }\n            else if (functionName === \"get_widget_class\") {\n                return widgetClass;\n            }\n            else {\n                return callFunction(this, functionName, args);\n            }\n        }\n    };\n};\nvar SimpleWidget = /** @class */ (function () {\n    function SimpleWidget(el, options) {\n        this.$el = jQuery(el);\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        var defaults = this.constructor[\"defaults\"];\n        this.options = jQuery.extend({}, defaults, options);\n    }\n    SimpleWidget.register = function (widgetClass, widgetName) {\n        register(widgetClass, widgetName);\n    };\n    SimpleWidget.prototype.destroy = function () {\n        this.deinit();\n    };\n    SimpleWidget.prototype.init = function () {\n        //\n    };\n    SimpleWidget.prototype.deinit = function () {\n        //\n    };\n    SimpleWidget.defaults = {};\n    return SimpleWidget;\n}());\nexports[\"default\"] = SimpleWidget;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nexports.__esModule = true;\nexports.JqTreeWidget = void 0;\nvar version_1 = require(\"./version\");\nvar jQuery = require(\"jquery\");\nvar dragAndDropHandler_1 = require(\"./dragAndDropHandler\");\nvar elementsRenderer_1 = require(\"./elementsRenderer\");\nvar dataLoader_1 = require(\"./dataLoader\");\nvar keyHandler_1 = require(\"./keyHandler\");\nvar mouse_widget_1 = require(\"./mouse.widget\");\nvar saveStateHandler_1 = require(\"./saveStateHandler\");\nvar scrollHandler_1 = require(\"./scrollHandler\");\nvar selectNodeHandler_1 = require(\"./selectNodeHandler\");\nvar simple_widget_1 = require(\"./simple.widget\");\nvar node_1 = require(\"./node\");\nvar util_1 = require(\"./util\");\nvar nodeElement_1 = require(\"./nodeElement\");\nvar NODE_PARAM_IS_EMPTY = \"Node parameter is empty\";\nvar PARAM_IS_EMPTY = \"Parameter is empty: \";\nvar JqTreeWidget = /** @class */ (function (_super) {\n    __extends(JqTreeWidget, _super);\n    function JqTreeWidget() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.handleClick = function (e) {\n            var clickTarget = _this.getClickTarget(e.target);\n            if (clickTarget) {\n                if (clickTarget.type === \"button\") {\n                    _this.toggle(clickTarget.node, _this.options.slide);\n                    e.preventDefault();\n                    e.stopPropagation();\n                }\n                else if (clickTarget.type === \"label\") {\n                    var node = clickTarget.node;\n                    var event_1 = _this._triggerEvent(\"tree.click\", {\n                        node: node,\n                        click_event: e\n                    });\n                    if (!event_1.isDefaultPrevented()) {\n                        _this.doSelectNode(node);\n                    }\n                }\n            }\n        };\n        _this.handleDblclick = function (e) {\n            var clickTarget = _this.getClickTarget(e.target);\n            if ((clickTarget === null || clickTarget === void 0 ? void 0 : clickTarget.type) === \"label\") {\n                _this._triggerEvent(\"tree.dblclick\", {\n                    node: clickTarget.node,\n                    click_event: e\n                });\n            }\n        };\n        _this.handleContextmenu = function (e) {\n            var $div = jQuery(e.target).closest(\"ul.jqtree-tree .jqtree-element\");\n            if ($div.length) {\n                var node = _this.getNode($div);\n                if (node) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    _this._triggerEvent(\"tree.contextmenu\", {\n                        node: node,\n                        click_event: e\n                    });\n                    return false;\n                }\n            }\n            return null;\n        };\n        return _this;\n    }\n    JqTreeWidget.prototype.toggle = function (node, slideParam) {\n        if (slideParam === void 0) { slideParam = null; }\n        if (!node) {\n            throw Error(NODE_PARAM_IS_EMPTY);\n        }\n        var slide = slideParam !== null && slideParam !== void 0 ? slideParam : this.options.slide;\n        if (node.is_open) {\n            this.closeNode(node, slide);\n        }\n        else {\n            this.openNode(node, slide);\n        }\n        return this.element;\n    };\n    JqTreeWidget.prototype.getTree = function () {\n        return this.tree;\n    };\n    JqTreeWidget.prototype.selectNode = function (node, optionsParam) {\n        this.doSelectNode(node, optionsParam);\n        return this.element;\n    };\n    JqTreeWidget.prototype.getSelectedNode = function () {\n        return this.selectNodeHandler.getSelectedNode();\n    };\n    JqTreeWidget.prototype.toJson = function () {\n        return JSON.stringify(this.tree.getData());\n    };\n    JqTreeWidget.prototype.loadData = function (data, parentNode) {\n        this.doLoadData(data, parentNode);\n        return this.element;\n    };\n    /*\n    signatures:\n    - loadDataFromUrl(url, parent_node=null, on_finished=null)\n        loadDataFromUrl('/my_data');\n        loadDataFromUrl('/my_data', node1);\n        loadDataFromUrl('/my_data', node1, function() { console.log('finished'); });\n        loadDataFromUrl('/my_data', null, function() { console.log('finished'); });\n\n    - loadDataFromUrl(parent_node=null, on_finished=null)\n        loadDataFromUrl();\n        loadDataFromUrl(node1);\n        loadDataFromUrl(null, function() { console.log('finished'); });\n        loadDataFromUrl(node1, function() { console.log('finished'); });\n    */\n    JqTreeWidget.prototype.loadDataFromUrl = function (param1, param2, param3) {\n        if (typeof param1 === \"string\") {\n            // first parameter is url\n            this.doLoadDataFromUrl(param1, param2, param3 !== null && param3 !== void 0 ? param3 : null);\n        }\n        else {\n            // first parameter is not url\n            this.doLoadDataFromUrl(null, param1, param2);\n        }\n        return this.element;\n    };\n    JqTreeWidget.prototype.reload = function (onFinished) {\n        this.doLoadDataFromUrl(null, null, onFinished);\n        return this.element;\n    };\n    JqTreeWidget.prototype.getNodeById = function (nodeId) {\n        return this.tree.getNodeById(nodeId);\n    };\n    JqTreeWidget.prototype.getNodeByName = function (name) {\n        return this.tree.getNodeByName(name);\n    };\n    JqTreeWidget.prototype.getNodeByNameMustExist = function (name) {\n        return this.tree.getNodeByNameMustExist(name);\n    };\n    JqTreeWidget.prototype.getNodesByProperty = function (key, value) {\n        return this.tree.getNodesByProperty(key, value);\n    };\n    JqTreeWidget.prototype.getNodeByHtmlElement = function (element) {\n        return this.getNode(jQuery(element));\n    };\n    JqTreeWidget.prototype.getNodeByCallback = function (callback) {\n        return this.tree.getNodeByCallback(callback);\n    };\n    JqTreeWidget.prototype.openNode = function (node, param1, param2) {\n        var _this = this;\n        if (!node) {\n            throw Error(NODE_PARAM_IS_EMPTY);\n        }\n        var parseParams = function () {\n            var _a;\n            var onFinished;\n            var slide;\n            if (util_1.isFunction(param1)) {\n                onFinished = param1;\n                slide = null;\n            }\n            else {\n                slide = param1;\n                onFinished = param2;\n            }\n            if (slide == null) {\n                slide = (_a = _this.options.slide) !== null && _a !== void 0 ? _a : false;\n            }\n            return [slide, onFinished];\n        };\n        var _a = parseParams(), slide = _a[0], onFinished = _a[1];\n        this._openNode(node, slide, onFinished);\n        return this.element;\n    };\n    JqTreeWidget.prototype.closeNode = function (node, slideParam) {\n        if (!node) {\n            throw Error(NODE_PARAM_IS_EMPTY);\n        }\n        var slide = slideParam !== null && slideParam !== void 0 ? slideParam : this.options.slide;\n        if (node.isFolder() || node.isEmptyFolder) {\n            new nodeElement_1.FolderElement(node, this).close(slide, this.options.animationSpeed);\n            this.saveState();\n        }\n        return this.element;\n    };\n    JqTreeWidget.prototype.isDragging = function () {\n        return this.dndHandler.isDragging;\n    };\n    JqTreeWidget.prototype.refreshHitAreas = function () {\n        this.dndHandler.refresh();\n        return this.element;\n    };\n    JqTreeWidget.prototype.addNodeAfter = function (newNodeInfo, existingNode) {\n        var newNode = existingNode.addAfter(newNodeInfo);\n        if (newNode) {\n            this._refreshElements(existingNode.parent);\n        }\n        return newNode;\n    };\n    JqTreeWidget.prototype.addNodeBefore = function (newNodeInfo, existingNode) {\n        if (!existingNode) {\n            throw Error(PARAM_IS_EMPTY + \"existingNode\");\n        }\n        var newNode = existingNode.addBefore(newNodeInfo);\n        if (newNode) {\n            this._refreshElements(existingNode.parent);\n        }\n        return newNode;\n    };\n    JqTreeWidget.prototype.addParentNode = function (newNodeInfo, existingNode) {\n        if (!existingNode) {\n            throw Error(PARAM_IS_EMPTY + \"existingNode\");\n        }\n        var newNode = existingNode.addParent(newNodeInfo);\n        if (newNode) {\n            this._refreshElements(newNode.parent);\n        }\n        return newNode;\n    };\n    JqTreeWidget.prototype.removeNode = function (node) {\n        if (!node) {\n            throw Error(NODE_PARAM_IS_EMPTY);\n        }\n        if (!node.parent) {\n            throw Error(\"Node has no parent\");\n        }\n        this.selectNodeHandler.removeFromSelection(node, true); // including children\n        var parent = node.parent;\n        node.remove();\n        this._refreshElements(parent);\n        return this.element;\n    };\n    JqTreeWidget.prototype.appendNode = function (newNodeInfo, parentNodeParam) {\n        var parentNode = parentNodeParam || this.tree;\n        var node = parentNode.append(newNodeInfo);\n        this._refreshElements(parentNode);\n        return node;\n    };\n    JqTreeWidget.prototype.prependNode = function (newNodeInfo, parentNodeParam) {\n        var parentNode = parentNodeParam !== null && parentNodeParam !== void 0 ? parentNodeParam : this.tree;\n        var node = parentNode.prepend(newNodeInfo);\n        this._refreshElements(parentNode);\n        return node;\n    };\n    JqTreeWidget.prototype.updateNode = function (node, data) {\n        if (!node) {\n            throw Error(NODE_PARAM_IS_EMPTY);\n        }\n        var idIsChanged = typeof data === \"object\" && data.id && data.id !== node.id;\n        if (idIsChanged) {\n            this.tree.removeNodeFromIndex(node);\n        }\n        node.setData(data);\n        if (idIsChanged) {\n            this.tree.addNodeToIndex(node);\n        }\n        if (typeof data === \"object\" &&\n            data[\"children\"] &&\n            data[\"children\"] instanceof Array) {\n            node.removeChildren();\n            if (data.children.length) {\n                node.loadFromData(data.children);\n            }\n        }\n        this._refreshElements(node);\n        this.selectCurrentNode();\n        return this.element;\n    };\n    JqTreeWidget.prototype.moveNode = function (node, targetNode, position) {\n        if (!node) {\n            throw Error(NODE_PARAM_IS_EMPTY);\n        }\n        if (!targetNode) {\n            throw Error(PARAM_IS_EMPTY + \"targetNode\");\n        }\n        var positionIndex = node_1.getPosition(position);\n        if (positionIndex !== undefined) {\n            this.tree.moveNode(node, targetNode, positionIndex);\n            this._refreshElements(null);\n        }\n        return this.element;\n    };\n    JqTreeWidget.prototype.getStateFromStorage = function () {\n        return this.saveStateHandler.getStateFromStorage();\n    };\n    JqTreeWidget.prototype.addToSelection = function (node, mustSetFocus) {\n        if (!node) {\n            throw Error(NODE_PARAM_IS_EMPTY);\n        }\n        this.selectNodeHandler.addToSelection(node);\n        this._getNodeElementForNode(node).select(mustSetFocus === undefined ? true : mustSetFocus);\n        this.saveState();\n        return this.element;\n    };\n    JqTreeWidget.prototype.getSelectedNodes = function () {\n        return this.selectNodeHandler.getSelectedNodes();\n    };\n    JqTreeWidget.prototype.isNodeSelected = function (node) {\n        if (!node) {\n            throw Error(NODE_PARAM_IS_EMPTY);\n        }\n        return this.selectNodeHandler.isNodeSelected(node);\n    };\n    JqTreeWidget.prototype.removeFromSelection = function (node) {\n        if (!node) {\n            throw Error(NODE_PARAM_IS_EMPTY);\n        }\n        this.selectNodeHandler.removeFromSelection(node);\n        this._getNodeElementForNode(node).deselect();\n        this.saveState();\n        return this.element;\n    };\n    JqTreeWidget.prototype.scrollToNode = function (node) {\n        if (!node) {\n            throw Error(NODE_PARAM_IS_EMPTY);\n        }\n        var nodeOffset = jQuery(node.element).offset();\n        var nodeTop = nodeOffset ? nodeOffset.top : 0;\n        var treeOffset = this.$el.offset();\n        var treeTop = treeOffset ? treeOffset.top : 0;\n        var top = nodeTop - treeTop;\n        this.scrollHandler.scrollToY(top);\n        return this.element;\n    };\n    JqTreeWidget.prototype.getState = function () {\n        return this.saveStateHandler.getState();\n    };\n    JqTreeWidget.prototype.setState = function (state) {\n        this.saveStateHandler.setInitialState(state);\n        this._refreshElements(null);\n        return this.element;\n    };\n    JqTreeWidget.prototype.setOption = function (option, value) {\n        this.options[option] = value;\n        return this.element;\n    };\n    JqTreeWidget.prototype.moveDown = function () {\n        var selectedNode = this.getSelectedNode();\n        if (selectedNode) {\n            this.keyHandler.moveDown(selectedNode);\n        }\n        return this.element;\n    };\n    JqTreeWidget.prototype.moveUp = function () {\n        var selectedNode = this.getSelectedNode();\n        if (selectedNode) {\n            this.keyHandler.moveUp(selectedNode);\n        }\n        return this.element;\n    };\n    JqTreeWidget.prototype.getVersion = function () {\n        return version_1[\"default\"];\n    };\n    JqTreeWidget.prototype._triggerEvent = function (eventName, values) {\n        var event = jQuery.Event(eventName);\n        jQuery.extend(event, values);\n        this.element.trigger(event);\n        return event;\n    };\n    JqTreeWidget.prototype._openNode = function (node, slide, onFinished) {\n        var _this = this;\n        if (slide === void 0) { slide = true; }\n        var doOpenNode = function (_node, _slide, _onFinished) {\n            var folderElement = new nodeElement_1.FolderElement(_node, _this);\n            folderElement.open(_onFinished, _slide, _this.options.animationSpeed);\n        };\n        if (node.isFolder() || node.isEmptyFolder) {\n            if (node.load_on_demand) {\n                this.loadFolderOnDemand(node, slide, onFinished);\n            }\n            else {\n                var parent_1 = node.parent;\n                while (parent_1) {\n                    // nb: do not open root element\n                    if (parent_1.parent) {\n                        doOpenNode(parent_1, false, null);\n                    }\n                    parent_1 = parent_1.parent;\n                }\n                doOpenNode(node, slide, onFinished);\n                this.saveState();\n            }\n        }\n    };\n    /*\n    Redraw the tree or part of the tree.\n     from_node: redraw this subtree\n    */\n    JqTreeWidget.prototype._refreshElements = function (fromNode) {\n        this.renderer.render(fromNode);\n        this._triggerEvent(\"tree.refresh\");\n    };\n    JqTreeWidget.prototype._getNodeElementForNode = function (node) {\n        if (node.isFolder()) {\n            return new nodeElement_1.FolderElement(node, this);\n        }\n        else {\n            return new nodeElement_1.NodeElement(node, this);\n        }\n    };\n    JqTreeWidget.prototype._getNodeElement = function ($element) {\n        var node = this.getNode($element);\n        if (node) {\n            return this._getNodeElementForNode(node);\n        }\n        else {\n            return null;\n        }\n    };\n    JqTreeWidget.prototype._containsElement = function (element) {\n        var node = this.getNode(jQuery(element));\n        return node != null && node.tree === this.tree;\n    };\n    JqTreeWidget.prototype._getScrollLeft = function () {\n        return this.scrollHandler.getScrollLeft();\n    };\n    JqTreeWidget.prototype.init = function () {\n        _super.prototype.init.call(this);\n        this.element = this.$el;\n        this.mouseDelay = 300;\n        this.isInitialized = false;\n        this.options.rtl = this.getRtlOption();\n        if (this.options.closedIcon == null) {\n            this.options.closedIcon = this.getDefaultClosedIcon();\n        }\n        this.renderer = new elementsRenderer_1[\"default\"](this);\n        this.dataLoader = new dataLoader_1[\"default\"](this);\n        this.saveStateHandler = new saveStateHandler_1[\"default\"](this);\n        this.selectNodeHandler = new selectNodeHandler_1[\"default\"](this);\n        this.dndHandler = new dragAndDropHandler_1.DragAndDropHandler(this);\n        this.scrollHandler = new scrollHandler_1[\"default\"](this);\n        this.keyHandler = new keyHandler_1[\"default\"](this);\n        this.initData();\n        this.element.click(this.handleClick);\n        this.element.dblclick(this.handleDblclick);\n        if (this.options.useContextMenu) {\n            this.element.on(\"contextmenu\", this.handleContextmenu);\n        }\n    };\n    JqTreeWidget.prototype.deinit = function () {\n        this.element.empty();\n        this.element.off();\n        this.keyHandler.deinit();\n        this.tree = new node_1.Node({}, true);\n        _super.prototype.deinit.call(this);\n    };\n    JqTreeWidget.prototype.mouseCapture = function (positionInfo) {\n        if (this.options.dragAndDrop) {\n            return this.dndHandler.mouseCapture(positionInfo);\n        }\n        else {\n            return false;\n        }\n    };\n    JqTreeWidget.prototype.mouseStart = function (positionInfo) {\n        if (this.options.dragAndDrop) {\n            return this.dndHandler.mouseStart(positionInfo);\n        }\n        else {\n            return false;\n        }\n    };\n    JqTreeWidget.prototype.mouseDrag = function (positionInfo) {\n        if (this.options.dragAndDrop) {\n            var result = this.dndHandler.mouseDrag(positionInfo);\n            this.scrollHandler.checkScrolling();\n            return result;\n        }\n        else {\n            return false;\n        }\n    };\n    JqTreeWidget.prototype.mouseStop = function (positionInfo) {\n        if (this.options.dragAndDrop) {\n            return this.dndHandler.mouseStop(positionInfo);\n        }\n        else {\n            return false;\n        }\n    };\n    JqTreeWidget.prototype.initData = function () {\n        if (this.options.data) {\n            this.doLoadData(this.options.data, null);\n        }\n        else {\n            var dataUrl = this.getDataUrlInfo(null);\n            if (dataUrl) {\n                this.doLoadDataFromUrl(null, null, null);\n            }\n            else {\n                this.doLoadData([], null);\n            }\n        }\n    };\n    JqTreeWidget.prototype.getDataUrlInfo = function (node) {\n        var _this = this;\n        var dataUrl = this.options.dataUrl || this.element.data(\"url\");\n        var getUrlFromString = function (url) {\n            var urlInfo = { url: url };\n            setUrlInfoData(urlInfo);\n            return urlInfo;\n        };\n        var setUrlInfoData = function (urlInfo) {\n            if (node === null || node === void 0 ? void 0 : node.id) {\n                // Load on demand of a subtree; add node parameter\n                var data = { node: node.id };\n                urlInfo[\"data\"] = data;\n            }\n            else {\n                // Add selected_node parameter\n                var selectedNodeId = _this.getNodeIdToBeSelected();\n                if (selectedNodeId) {\n                    var data = { selected_node: selectedNodeId };\n                    urlInfo[\"data\"] = data;\n                }\n            }\n        };\n        if (typeof dataUrl === \"function\") {\n            return dataUrl(node);\n        }\n        else if (typeof dataUrl === \"string\") {\n            return getUrlFromString(dataUrl);\n        }\n        else if (dataUrl && typeof dataUrl === \"object\") {\n            setUrlInfoData(dataUrl);\n            return dataUrl;\n        }\n        else {\n            return null;\n        }\n    };\n    JqTreeWidget.prototype.getNodeIdToBeSelected = function () {\n        if (this.options.saveState) {\n            return this.saveStateHandler.getNodeIdToBeSelected();\n        }\n        else {\n            return null;\n        }\n    };\n    JqTreeWidget.prototype.initTree = function (data) {\n        var _this = this;\n        var doInit = function () {\n            if (!_this.isInitialized) {\n                _this.isInitialized = true;\n                _this._triggerEvent(\"tree.init\");\n            }\n        };\n        if (!this.options.nodeClass) {\n            return;\n        }\n        this.tree = new this.options.nodeClass(null, true, this.options.nodeClass);\n        this.selectNodeHandler.clear();\n        this.tree.loadFromData(data);\n        var mustLoadOnDemand = this.setInitialState();\n        this._refreshElements(null);\n        if (!mustLoadOnDemand) {\n            doInit();\n        }\n        else {\n            // Load data on demand and then init the tree\n            this.setInitialStateOnDemand(doInit);\n        }\n    };\n    // Set initial state, either by restoring the state or auto-opening nodes\n    // result: must load nodes on demand?\n    JqTreeWidget.prototype.setInitialState = function () {\n        var _this = this;\n        var restoreState = function () {\n            // result: is state restored, must load on demand?\n            if (!_this.options.saveState) {\n                return [false, false];\n            }\n            else {\n                var state = _this.saveStateHandler.getStateFromStorage();\n                if (!state) {\n                    return [false, false];\n                }\n                else {\n                    var mustLoadOnDemand_1 = _this.saveStateHandler.setInitialState(state);\n                    // return true: the state is restored\n                    return [true, mustLoadOnDemand_1];\n                }\n            }\n        };\n        var autoOpenNodes = function () {\n            // result: must load on demand?\n            if (_this.options.autoOpen === false) {\n                return false;\n            }\n            var maxLevel = _this.getAutoOpenMaxLevel();\n            var mustLoadOnDemand = false;\n            _this.tree.iterate(function (node, level) {\n                if (node.load_on_demand) {\n                    mustLoadOnDemand = true;\n                    return false;\n                }\n                else if (!node.hasChildren()) {\n                    return false;\n                }\n                else {\n                    node.is_open = true;\n                    return level !== maxLevel;\n                }\n            });\n            return mustLoadOnDemand;\n        };\n        var _a = restoreState(), isRestored = _a[0], mustLoadOnDemand = _a[1]; // eslint-disable-line prefer-const\n        if (!isRestored) {\n            mustLoadOnDemand = autoOpenNodes();\n        }\n        return mustLoadOnDemand;\n    };\n    // Set the initial state for nodes that are loaded on demand\n    // Call cb_finished when done\n    JqTreeWidget.prototype.setInitialStateOnDemand = function (cbFinished) {\n        var _this = this;\n        var restoreState = function () {\n            if (!_this.options.saveState) {\n                return false;\n            }\n            else {\n                var state = _this.saveStateHandler.getStateFromStorage();\n                if (!state) {\n                    return false;\n                }\n                else {\n                    _this.saveStateHandler.setInitialStateOnDemand(state, cbFinished);\n                    return true;\n                }\n            }\n        };\n        var autoOpenNodes = function () {\n            var maxLevel = _this.getAutoOpenMaxLevel();\n            var loadingCount = 0;\n            var loadAndOpenNode = function (node) {\n                loadingCount += 1;\n                _this._openNode(node, false, function () {\n                    loadingCount -= 1;\n                    openNodes();\n                });\n            };\n            var openNodes = function () {\n                _this.tree.iterate(function (node, level) {\n                    if (node.load_on_demand) {\n                        if (!node.is_loading) {\n                            loadAndOpenNode(node);\n                        }\n                        return false;\n                    }\n                    else {\n                        _this._openNode(node, false, null);\n                        return level !== maxLevel;\n                    }\n                });\n                if (loadingCount === 0) {\n                    cbFinished();\n                }\n            };\n            openNodes();\n        };\n        if (!restoreState()) {\n            autoOpenNodes();\n        }\n    };\n    JqTreeWidget.prototype.getAutoOpenMaxLevel = function () {\n        if (this.options.autoOpen === true) {\n            return -1;\n        }\n        else if (typeof this.options.autoOpen === \"number\") {\n            return this.options.autoOpen;\n        }\n        else if (typeof this.options.autoOpen === \"string\") {\n            return parseInt(this.options.autoOpen, 10);\n        }\n        else {\n            return 0;\n        }\n    };\n    JqTreeWidget.prototype.getClickTarget = function (element) {\n        var $target = jQuery(element);\n        var $button = $target.closest(\".jqtree-toggler\");\n        if ($button.length) {\n            var node = this.getNode($button);\n            if (node) {\n                return {\n                    type: \"button\",\n                    node: node\n                };\n            }\n        }\n        else {\n            var $el = $target.closest(\".jqtree-element\");\n            if ($el.length) {\n                var node = this.getNode($el);\n                if (node) {\n                    return {\n                        type: \"label\",\n                        node: node\n                    };\n                }\n            }\n        }\n        return null;\n    };\n    JqTreeWidget.prototype.getNode = function ($element) {\n        var $li = $element.closest(\"li.jqtree_common\");\n        if ($li.length === 0) {\n            return null;\n        }\n        else {\n            return $li.data(\"node\");\n        }\n    };\n    JqTreeWidget.prototype.saveState = function () {\n        if (this.options.saveState) {\n            this.saveStateHandler.saveState();\n        }\n    };\n    JqTreeWidget.prototype.selectCurrentNode = function () {\n        var node = this.getSelectedNode();\n        if (node) {\n            var nodeElement = this._getNodeElementForNode(node);\n            if (nodeElement) {\n                nodeElement.select(true);\n            }\n        }\n    };\n    JqTreeWidget.prototype.deselectCurrentNode = function () {\n        var node = this.getSelectedNode();\n        if (node) {\n            this.removeFromSelection(node);\n        }\n    };\n    JqTreeWidget.prototype.getDefaultClosedIcon = function () {\n        if (this.options.rtl) {\n            // triangle to the left\n            return \"&#x25c0;\";\n        }\n        else {\n            // triangle to the right\n            return \"&#x25ba;\";\n        }\n    };\n    JqTreeWidget.prototype.getRtlOption = function () {\n        if (this.options.rtl != null) {\n            return this.options.rtl;\n        }\n        else {\n            var dataRtl = this.element.data(\"rtl\");\n            if (dataRtl !== null &&\n                dataRtl !== false &&\n                dataRtl !== undefined) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n    };\n    JqTreeWidget.prototype.doSelectNode = function (node, optionsParam) {\n        var _this = this;\n        var saveState = function () {\n            if (_this.options.saveState) {\n                _this.saveStateHandler.saveState();\n            }\n        };\n        if (!node) {\n            // Called with empty node -> deselect current node\n            this.deselectCurrentNode();\n            saveState();\n            return;\n        }\n        var defaultOptions = { mustSetFocus: true, mustToggle: true };\n        var selectOptions = __assign(__assign({}, defaultOptions), (optionsParam || {}));\n        var canSelect = function () {\n            if (_this.options.onCanSelectNode) {\n                return (_this.options.selectable === true &&\n                    _this.options.onCanSelectNode(node));\n            }\n            else {\n                return _this.options.selectable === true;\n            }\n        };\n        var openParents = function () {\n            var parent = node.parent;\n            if (parent && parent.parent && !parent.is_open) {\n                _this.openNode(parent, false);\n            }\n        };\n        if (!canSelect()) {\n            return;\n        }\n        if (this.selectNodeHandler.isNodeSelected(node)) {\n            if (selectOptions.mustToggle) {\n                this.deselectCurrentNode();\n                this._triggerEvent(\"tree.select\", {\n                    node: null,\n                    previous_node: node\n                });\n            }\n        }\n        else {\n            var deselectedNode = this.getSelectedNode() || null;\n            this.deselectCurrentNode();\n            this.addToSelection(node, selectOptions.mustSetFocus);\n            this._triggerEvent(\"tree.select\", {\n                node: node,\n                deselected_node: deselectedNode\n            });\n            openParents();\n        }\n        saveState();\n    };\n    JqTreeWidget.prototype.doLoadData = function (data, parentNode) {\n        if (!data) {\n            return;\n        }\n        else {\n            this._triggerEvent(\"tree.load_data\", { tree_data: data });\n            if (parentNode) {\n                this.deselectNodes(parentNode);\n                this.loadSubtree(data, parentNode);\n            }\n            else {\n                this.initTree(data);\n            }\n            if (this.isDragging()) {\n                this.dndHandler.refresh();\n            }\n        }\n    };\n    JqTreeWidget.prototype.deselectNodes = function (parentNode) {\n        var selectedNodesUnderParent = this.selectNodeHandler.getSelectedNodesUnder(parentNode);\n        for (var _i = 0, selectedNodesUnderParent_1 = selectedNodesUnderParent; _i < selectedNodesUnderParent_1.length; _i++) {\n            var n = selectedNodesUnderParent_1[_i];\n            this.selectNodeHandler.removeFromSelection(n);\n        }\n    };\n    JqTreeWidget.prototype.loadSubtree = function (data, parentNode) {\n        parentNode.loadFromData(data);\n        parentNode.load_on_demand = false;\n        parentNode.is_loading = false;\n        this._refreshElements(parentNode);\n    };\n    JqTreeWidget.prototype.doLoadDataFromUrl = function (urlInfoParam, parentNode, onFinished) {\n        var urlInfo = urlInfoParam || this.getDataUrlInfo(parentNode);\n        this.dataLoader.loadFromUrl(urlInfo, parentNode, onFinished);\n    };\n    JqTreeWidget.prototype.loadFolderOnDemand = function (node, slide, onFinished) {\n        var _this = this;\n        if (slide === void 0) { slide = true; }\n        node.is_loading = true;\n        this.doLoadDataFromUrl(null, node, function () {\n            _this._openNode(node, slide, onFinished);\n        });\n    };\n    JqTreeWidget.defaults = {\n        animationSpeed: \"fast\",\n        autoOpen: false,\n        saveState: false,\n        dragAndDrop: false,\n        selectable: true,\n        useContextMenu: true,\n        onCanSelectNode: undefined,\n        onSetStateFromStorage: undefined,\n        onGetStateFromStorage: undefined,\n        onCreateLi: undefined,\n        onIsMoveHandle: undefined,\n        // Can this node be moved?\n        onCanMove: undefined,\n        // Can this node be moved to this position? function(moved_node, target_node, position)\n        onCanMoveTo: undefined,\n        onLoadFailed: undefined,\n        autoEscape: true,\n        dataUrl: undefined,\n        // The symbol to use for a closed node -  BLACK RIGHT-POINTING POINTER\n        // http://www.fileformat.info/info/unicode/char/25ba/index.htm\n        closedIcon: undefined,\n        // The symbol to use for an open node -  BLACK DOWN-POINTING TRIANGLE\n        // http://www.fileformat.info/info/unicode/char/25bc/index.htm\n        openedIcon: \"&#x25bc;\",\n        slide: true,\n        nodeClass: node_1.Node,\n        dataFilter: undefined,\n        keyboardSupport: true,\n        openFolderDelay: 500,\n        rtl: undefined,\n        onDragMove: undefined,\n        onDragStop: undefined,\n        buttonLeft: true,\n        onLoading: undefined,\n        showEmptyFolder: false,\n        tabIndex: 0\n    };\n    return JqTreeWidget;\n}(mouse_widget_1[\"default\"]));\nexports.JqTreeWidget = JqTreeWidget;\nsimple_widget_1[\"default\"].register(JqTreeWidget, \"tree\");\n","\"use strict\";\nexports.__esModule = true;\nexports.getBoolString = exports.isFunction = exports.isInt = void 0;\nexports.isInt = function (n) {\n    return typeof n === \"number\" && n % 1 === 0;\n};\nexports.isFunction = function (v) { return typeof v === \"function\"; };\nexports.getBoolString = function (value) {\n    return value ? \"true\" : \"false\";\n};\n","\"use strict\";\nexports.__esModule = true;\nvar version = \"1.5.0\";\nexports[\"default\"] = version;\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , undef;\n\n/**\n * Decode a URI encoded string.\n *\n * @param {String} input The URI encoded string.\n * @returns {String|Null} The decoded string.\n * @api private\n */\nfunction decode(input) {\n  try {\n    return decodeURIComponent(input.replace(/\\+/g, ' '));\n  } catch (e) {\n    return null;\n  }\n}\n\n/**\n * Attempts to encode a given input.\n *\n * @param {String} input The string that needs to be encoded.\n * @returns {String|Null} The encoded string.\n * @api private\n */\nfunction encode(input) {\n  try {\n    return encodeURIComponent(input);\n  } catch (e) {\n    return null;\n  }\n}\n\n/**\n * Simple query string parser.\n *\n * @param {String} query The query string that needs to be parsed.\n * @returns {Object}\n * @api public\n */\nfunction querystring(query) {\n  var parser = /([^=?#&]+)=?([^&]*)/g\n    , result = {}\n    , part;\n\n  while (part = parser.exec(query)) {\n    var key = decode(part[1])\n      , value = decode(part[2]);\n\n    //\n    // Prevent overriding of existing properties. This ensures that build-in\n    // methods like `toString` or __proto__ are not overriden by malicious\n    // querystrings.\n    //\n    // In the case if failed decoding, we want to omit the key/value pairs\n    // from the result.\n    //\n    if (key === null || value === null || key in result) continue;\n    result[key] = value;\n  }\n\n  return result;\n}\n\n/**\n * Transform a query string to an object.\n *\n * @param {Object} obj Object that should be transformed.\n * @param {String} prefix Optional prefix.\n * @returns {String}\n * @api public\n */\nfunction querystringify(obj, prefix) {\n  prefix = prefix || '';\n\n  var pairs = []\n    , value\n    , key;\n\n  //\n  // Optionally prefix with a '?' if needed\n  //\n  if ('string' !== typeof prefix) prefix = '?';\n\n  for (key in obj) {\n    if (has.call(obj, key)) {\n      value = obj[key];\n\n      //\n      // Edge cases where we actually want to encode the value to an empty\n      // string instead of the stringified value.\n      //\n      if (!value && (value === null || value === undef || isNaN(value))) {\n        value = '';\n      }\n\n      key = encode(key);\n      value = encode(value);\n\n      //\n      // If we failed to encode the strings, we should bail out as we don't\n      // want to add invalid strings to the query.\n      //\n      if (key === null || value === null) continue;\n      pairs.push(key +'='+ value);\n    }\n  }\n\n  return pairs.length ? prefix + pairs.join('&') : '';\n}\n\n//\n// Expose the module.\n//\nexports.stringify = querystringify;\nexports.parse = querystring;\n","'use strict';\n\n/**\n * Check if we're required to add a port number.\n *\n * @see https://url.spec.whatwg.org/#default-port\n * @param {Number|String} port Port number we need to check\n * @param {String} protocol Protocol we need to check against.\n * @returns {Boolean} Is it a default port for the given protocol\n * @api private\n */\nmodule.exports = function required(port, protocol) {\n  protocol = protocol.split(':')[0];\n  port = +port;\n\n  if (!port) return false;\n\n  switch (protocol) {\n    case 'http':\n    case 'ws':\n    return port !== 80;\n\n    case 'https':\n    case 'wss':\n    return port !== 443;\n\n    case 'ftp':\n    return port !== 21;\n\n    case 'gopher':\n    return port !== 70;\n\n    case 'file':\n    return false;\n  }\n\n  return port !== 0;\n};\n","'use strict';\n\nvar required = require('requires-port')\n  , qs = require('querystringify')\n  , slashes = /^[A-Za-z][A-Za-z0-9+-.]*:\\/\\//\n  , protocolre = /^([a-z][a-z0-9.+-]*:)?(\\/\\/)?([\\S\\s]*)/i\n  , whitespace = '[\\\\x09\\\\x0A\\\\x0B\\\\x0C\\\\x0D\\\\x20\\\\xA0\\\\u1680\\\\u180E\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200A\\\\u202F\\\\u205F\\\\u3000\\\\u2028\\\\u2029\\\\uFEFF]'\n  , left = new RegExp('^'+ whitespace +'+');\n\n/**\n * Trim a given string.\n *\n * @param {String} str String to trim.\n * @public\n */\nfunction trimLeft(str) {\n  return (str ? str : '').toString().replace(left, '');\n}\n\n/**\n * These are the parse rules for the URL parser, it informs the parser\n * about:\n *\n * 0. The char it Needs to parse, if it's a string it should be done using\n *    indexOf, RegExp using exec and NaN means set as current value.\n * 1. The property we should set when parsing this value.\n * 2. Indication if it's backwards or forward parsing, when set as number it's\n *    the value of extra chars that should be split off.\n * 3. Inherit from location if non existing in the parser.\n * 4. `toLowerCase` the resulting value.\n */\nvar rules = [\n  ['#', 'hash'],                        // Extract from the back.\n  ['?', 'query'],                       // Extract from the back.\n  function sanitize(address) {          // Sanitize what is left of the address\n    return address.replace('\\\\', '/');\n  },\n  ['/', 'pathname'],                    // Extract from the back.\n  ['@', 'auth', 1],                     // Extract from the front.\n  [NaN, 'host', undefined, 1, 1],       // Set left over value.\n  [/:(\\d+)$/, 'port', undefined, 1],    // RegExp the back.\n  [NaN, 'hostname', undefined, 1, 1]    // Set left over.\n];\n\n/**\n * These properties should not be copied or inherited from. This is only needed\n * for all non blob URL's as a blob URL does not include a hash, only the\n * origin.\n *\n * @type {Object}\n * @private\n */\nvar ignore = { hash: 1, query: 1 };\n\n/**\n * The location object differs when your code is loaded through a normal page,\n * Worker or through a worker using a blob. And with the blobble begins the\n * trouble as the location object will contain the URL of the blob, not the\n * location of the page where our code is loaded in. The actual origin is\n * encoded in the `pathname` so we can thankfully generate a good \"default\"\n * location from it so we can generate proper relative URL's again.\n *\n * @param {Object|String} loc Optional default location object.\n * @returns {Object} lolcation object.\n * @public\n */\nfunction lolcation(loc) {\n  var globalVar;\n\n  if (typeof window !== 'undefined') globalVar = window;\n  else if (typeof global !== 'undefined') globalVar = global;\n  else if (typeof self !== 'undefined') globalVar = self;\n  else globalVar = {};\n\n  var location = globalVar.location || {};\n  loc = loc || location;\n\n  var finaldestination = {}\n    , type = typeof loc\n    , key;\n\n  if ('blob:' === loc.protocol) {\n    finaldestination = new Url(unescape(loc.pathname), {});\n  } else if ('string' === type) {\n    finaldestination = new Url(loc, {});\n    for (key in ignore) delete finaldestination[key];\n  } else if ('object' === type) {\n    for (key in loc) {\n      if (key in ignore) continue;\n      finaldestination[key] = loc[key];\n    }\n\n    if (finaldestination.slashes === undefined) {\n      finaldestination.slashes = slashes.test(loc.href);\n    }\n  }\n\n  return finaldestination;\n}\n\n/**\n * @typedef ProtocolExtract\n * @type Object\n * @property {String} protocol Protocol matched in the URL, in lowercase.\n * @property {Boolean} slashes `true` if protocol is followed by \"//\", else `false`.\n * @property {String} rest Rest of the URL that is not part of the protocol.\n */\n\n/**\n * Extract protocol information from a URL with/without double slash (\"//\").\n *\n * @param {String} address URL we want to extract from.\n * @return {ProtocolExtract} Extracted information.\n * @private\n */\nfunction extractProtocol(address) {\n  address = trimLeft(address);\n  var match = protocolre.exec(address);\n\n  return {\n    protocol: match[1] ? match[1].toLowerCase() : '',\n    slashes: !!match[2],\n    rest: match[3]\n  };\n}\n\n/**\n * Resolve a relative URL pathname against a base URL pathname.\n *\n * @param {String} relative Pathname of the relative URL.\n * @param {String} base Pathname of the base URL.\n * @return {String} Resolved pathname.\n * @private\n */\nfunction resolve(relative, base) {\n  if (relative === '') return base;\n\n  var path = (base || '/').split('/').slice(0, -1).concat(relative.split('/'))\n    , i = path.length\n    , last = path[i - 1]\n    , unshift = false\n    , up = 0;\n\n  while (i--) {\n    if (path[i] === '.') {\n      path.splice(i, 1);\n    } else if (path[i] === '..') {\n      path.splice(i, 1);\n      up++;\n    } else if (up) {\n      if (i === 0) unshift = true;\n      path.splice(i, 1);\n      up--;\n    }\n  }\n\n  if (unshift) path.unshift('');\n  if (last === '.' || last === '..') path.push('');\n\n  return path.join('/');\n}\n\n/**\n * The actual URL instance. Instead of returning an object we've opted-in to\n * create an actual constructor as it's much more memory efficient and\n * faster and it pleases my OCD.\n *\n * It is worth noting that we should not use `URL` as class name to prevent\n * clashes with the global URL instance that got introduced in browsers.\n *\n * @constructor\n * @param {String} address URL we want to parse.\n * @param {Object|String} [location] Location defaults for relative paths.\n * @param {Boolean|Function} [parser] Parser for the query string.\n * @private\n */\nfunction Url(address, location, parser) {\n  address = trimLeft(address);\n\n  if (!(this instanceof Url)) {\n    return new Url(address, location, parser);\n  }\n\n  var relative, extracted, parse, instruction, index, key\n    , instructions = rules.slice()\n    , type = typeof location\n    , url = this\n    , i = 0;\n\n  //\n  // The following if statements allows this module two have compatibility with\n  // 2 different API:\n  //\n  // 1. Node.js's `url.parse` api which accepts a URL, boolean as arguments\n  //    where the boolean indicates that the query string should also be parsed.\n  //\n  // 2. The `URL` interface of the browser which accepts a URL, object as\n  //    arguments. The supplied object will be used as default values / fall-back\n  //    for relative paths.\n  //\n  if ('object' !== type && 'string' !== type) {\n    parser = location;\n    location = null;\n  }\n\n  if (parser && 'function' !== typeof parser) parser = qs.parse;\n\n  location = lolcation(location);\n\n  //\n  // Extract protocol information before running the instructions.\n  //\n  extracted = extractProtocol(address || '');\n  relative = !extracted.protocol && !extracted.slashes;\n  url.slashes = extracted.slashes || relative && location.slashes;\n  url.protocol = extracted.protocol || location.protocol || '';\n  address = extracted.rest;\n\n  //\n  // When the authority component is absent the URL starts with a path\n  // component.\n  //\n  if (!extracted.slashes) instructions[3] = [/(.*)/, 'pathname'];\n\n  for (; i < instructions.length; i++) {\n    instruction = instructions[i];\n\n    if (typeof instruction === 'function') {\n      address = instruction(address);\n      continue;\n    }\n\n    parse = instruction[0];\n    key = instruction[1];\n\n    if (parse !== parse) {\n      url[key] = address;\n    } else if ('string' === typeof parse) {\n      if (~(index = address.indexOf(parse))) {\n        if ('number' === typeof instruction[2]) {\n          url[key] = address.slice(0, index);\n          address = address.slice(index + instruction[2]);\n        } else {\n          url[key] = address.slice(index);\n          address = address.slice(0, index);\n        }\n      }\n    } else if ((index = parse.exec(address))) {\n      url[key] = index[1];\n      address = address.slice(0, index.index);\n    }\n\n    url[key] = url[key] || (\n      relative && instruction[3] ? location[key] || '' : ''\n    );\n\n    //\n    // Hostname, host and protocol should be lowercased so they can be used to\n    // create a proper `origin`.\n    //\n    if (instruction[4]) url[key] = url[key].toLowerCase();\n  }\n\n  //\n  // Also parse the supplied query string in to an object. If we're supplied\n  // with a custom parser as function use that instead of the default build-in\n  // parser.\n  //\n  if (parser) url.query = parser(url.query);\n\n  //\n  // If the URL is relative, resolve the pathname against the base URL.\n  //\n  if (\n      relative\n    && location.slashes\n    && url.pathname.charAt(0) !== '/'\n    && (url.pathname !== '' || location.pathname !== '')\n  ) {\n    url.pathname = resolve(url.pathname, location.pathname);\n  }\n\n  //\n  // We should not add port numbers if they are already the default port number\n  // for a given protocol. As the host also contains the port number we're going\n  // override it with the hostname which contains no port number.\n  //\n  if (!required(url.port, url.protocol)) {\n    url.host = url.hostname;\n    url.port = '';\n  }\n\n  //\n  // Parse down the `auth` for the username and password.\n  //\n  url.username = url.password = '';\n  if (url.auth) {\n    instruction = url.auth.split(':');\n    url.username = instruction[0] || '';\n    url.password = instruction[1] || '';\n  }\n\n  url.origin = url.protocol && url.host && url.protocol !== 'file:'\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  //\n  // The href is just the compiled result.\n  //\n  url.href = url.toString();\n}\n\n/**\n * This is convenience method for changing properties in the URL instance to\n * insure that they all propagate correctly.\n *\n * @param {String} part          Property we need to adjust.\n * @param {Mixed} value          The newly assigned value.\n * @param {Boolean|Function} fn  When setting the query, it will be the function\n *                               used to parse the query.\n *                               When setting the protocol, double slash will be\n *                               removed from the final url if it is true.\n * @returns {URL} URL instance for chaining.\n * @public\n */\nfunction set(part, value, fn) {\n  var url = this;\n\n  switch (part) {\n    case 'query':\n      if ('string' === typeof value && value.length) {\n        value = (fn || qs.parse)(value);\n      }\n\n      url[part] = value;\n      break;\n\n    case 'port':\n      url[part] = value;\n\n      if (!required(value, url.protocol)) {\n        url.host = url.hostname;\n        url[part] = '';\n      } else if (value) {\n        url.host = url.hostname +':'+ value;\n      }\n\n      break;\n\n    case 'hostname':\n      url[part] = value;\n\n      if (url.port) value += ':'+ url.port;\n      url.host = value;\n      break;\n\n    case 'host':\n      url[part] = value;\n\n      if (/:\\d+$/.test(value)) {\n        value = value.split(':');\n        url.port = value.pop();\n        url.hostname = value.join(':');\n      } else {\n        url.hostname = value;\n        url.port = '';\n      }\n\n      break;\n\n    case 'protocol':\n      url.protocol = value.toLowerCase();\n      url.slashes = !fn;\n      break;\n\n    case 'pathname':\n    case 'hash':\n      if (value) {\n        var char = part === 'pathname' ? '/' : '#';\n        url[part] = value.charAt(0) !== char ? char + value : value;\n      } else {\n        url[part] = value;\n      }\n      break;\n\n    default:\n      url[part] = value;\n  }\n\n  for (var i = 0; i < rules.length; i++) {\n    var ins = rules[i];\n\n    if (ins[4]) url[ins[1]] = url[ins[1]].toLowerCase();\n  }\n\n  url.origin = url.protocol && url.host && url.protocol !== 'file:'\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  url.href = url.toString();\n\n  return url;\n}\n\n/**\n * Transform the properties back in to a valid and full URL string.\n *\n * @param {Function} stringify Optional query stringify function.\n * @returns {String} Compiled version of the URL.\n * @public\n */\nfunction toString(stringify) {\n  if (!stringify || 'function' !== typeof stringify) stringify = qs.stringify;\n\n  var query\n    , url = this\n    , protocol = url.protocol;\n\n  if (protocol && protocol.charAt(protocol.length - 1) !== ':') protocol += ':';\n\n  var result = protocol + (url.slashes ? '//' : '');\n\n  if (url.username) {\n    result += url.username;\n    if (url.password) result += ':'+ url.password;\n    result += '@';\n  }\n\n  result += url.host + url.pathname;\n\n  query = 'object' === typeof url.query ? stringify(url.query) : url.query;\n  if (query) result += '?' !== query.charAt(0) ? '?'+ query : query;\n\n  if (url.hash) result += url.hash;\n\n  return result;\n}\n\nUrl.prototype = { set: set, toString: toString };\n\n//\n// Expose the URL parser and some additional properties that might be useful for\n// others or testing.\n//\nUrl.extractProtocol = extractProtocol;\nUrl.location = lolcation;\nUrl.trimLeft = trimLeft;\nUrl.qs = qs;\n\nmodule.exports = Url;\n","module.exports = jQuery;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar defaults = {\r\n    lines: 12,\r\n    length: 7,\r\n    width: 5,\r\n    radius: 10,\r\n    scale: 1.0,\r\n    corners: 1,\r\n    color: '#000',\r\n    fadeColor: 'transparent',\r\n    animation: 'spinner-line-fade-default',\r\n    rotate: 0,\r\n    direction: 1,\r\n    speed: 1,\r\n    zIndex: 2e9,\r\n    className: 'spinner',\r\n    top: '50%',\r\n    left: '50%',\r\n    shadow: '0 0 1px transparent',\r\n    position: 'absolute',\r\n};\r\nvar Spinner = /** @class */ (function () {\r\n    function Spinner(opts) {\r\n        if (opts === void 0) { opts = {}; }\r\n        this.opts = __assign(__assign({}, defaults), opts);\r\n    }\r\n    /**\r\n     * Adds the spinner to the given target element. If this instance is already\r\n     * spinning, it is automatically removed from its previous target by calling\r\n     * stop() internally.\r\n     */\r\n    Spinner.prototype.spin = function (target) {\r\n        this.stop();\r\n        this.el = document.createElement('div');\r\n        this.el.className = this.opts.className;\r\n        this.el.setAttribute('role', 'progressbar');\r\n        css(this.el, {\r\n            position: this.opts.position,\r\n            width: 0,\r\n            zIndex: this.opts.zIndex,\r\n            left: this.opts.left,\r\n            top: this.opts.top,\r\n            transform: \"scale(\" + this.opts.scale + \")\",\r\n        });\r\n        if (target) {\r\n            target.insertBefore(this.el, target.firstChild || null);\r\n        }\r\n        drawLines(this.el, this.opts);\r\n        return this;\r\n    };\r\n    /**\r\n     * Stops and removes the Spinner.\r\n     * Stopped spinners may be reused by calling spin() again.\r\n     */\r\n    Spinner.prototype.stop = function () {\r\n        if (this.el) {\r\n            if (typeof requestAnimationFrame !== 'undefined') {\r\n                cancelAnimationFrame(this.animateId);\r\n            }\r\n            else {\r\n                clearTimeout(this.animateId);\r\n            }\r\n            if (this.el.parentNode) {\r\n                this.el.parentNode.removeChild(this.el);\r\n            }\r\n            this.el = undefined;\r\n        }\r\n        return this;\r\n    };\r\n    return Spinner;\r\n}());\r\nexport { Spinner };\r\n/**\r\n * Sets multiple style properties at once.\r\n */\r\nfunction css(el, props) {\r\n    for (var prop in props) {\r\n        el.style[prop] = props[prop];\r\n    }\r\n    return el;\r\n}\r\n/**\r\n * Returns the line color from the given string or array.\r\n */\r\nfunction getColor(color, idx) {\r\n    return typeof color == 'string' ? color : color[idx % color.length];\r\n}\r\n/**\r\n * Internal method that draws the individual lines.\r\n */\r\nfunction drawLines(el, opts) {\r\n    var borderRadius = (Math.round(opts.corners * opts.width * 500) / 1000) + 'px';\r\n    var shadow = 'none';\r\n    if (opts.shadow === true) {\r\n        shadow = '0 2px 4px #000'; // default shadow\r\n    }\r\n    else if (typeof opts.shadow === 'string') {\r\n        shadow = opts.shadow;\r\n    }\r\n    var shadows = parseBoxShadow(shadow);\r\n    for (var i = 0; i < opts.lines; i++) {\r\n        var degrees = ~~(360 / opts.lines * i + opts.rotate);\r\n        var backgroundLine = css(document.createElement('div'), {\r\n            position: 'absolute',\r\n            top: -opts.width / 2 + \"px\",\r\n            width: (opts.length + opts.width) + 'px',\r\n            height: opts.width + 'px',\r\n            background: getColor(opts.fadeColor, i),\r\n            borderRadius: borderRadius,\r\n            transformOrigin: 'left',\r\n            transform: \"rotate(\" + degrees + \"deg) translateX(\" + opts.radius + \"px)\",\r\n        });\r\n        var delay = i * opts.direction / opts.lines / opts.speed;\r\n        delay -= 1 / opts.speed; // so initial animation state will include trail\r\n        var line = css(document.createElement('div'), {\r\n            width: '100%',\r\n            height: '100%',\r\n            background: getColor(opts.color, i),\r\n            borderRadius: borderRadius,\r\n            boxShadow: normalizeShadow(shadows, degrees),\r\n            animation: 1 / opts.speed + \"s linear \" + delay + \"s infinite \" + opts.animation,\r\n        });\r\n        backgroundLine.appendChild(line);\r\n        el.appendChild(backgroundLine);\r\n    }\r\n}\r\nfunction parseBoxShadow(boxShadow) {\r\n    var regex = /^\\s*([a-zA-Z]+\\s+)?(-?\\d+(\\.\\d+)?)([a-zA-Z]*)\\s+(-?\\d+(\\.\\d+)?)([a-zA-Z]*)(.*)$/;\r\n    var shadows = [];\r\n    for (var _i = 0, _a = boxShadow.split(','); _i < _a.length; _i++) {\r\n        var shadow = _a[_i];\r\n        var matches = shadow.match(regex);\r\n        if (matches === null) {\r\n            continue; // invalid syntax\r\n        }\r\n        var x = +matches[2];\r\n        var y = +matches[5];\r\n        var xUnits = matches[4];\r\n        var yUnits = matches[7];\r\n        if (x === 0 && !xUnits) {\r\n            xUnits = yUnits;\r\n        }\r\n        if (y === 0 && !yUnits) {\r\n            yUnits = xUnits;\r\n        }\r\n        if (xUnits !== yUnits) {\r\n            continue; // units must match to use as coordinates\r\n        }\r\n        shadows.push({\r\n            prefix: matches[1] || '',\r\n            x: x,\r\n            y: y,\r\n            xUnits: xUnits,\r\n            yUnits: yUnits,\r\n            end: matches[8],\r\n        });\r\n    }\r\n    return shadows;\r\n}\r\n/**\r\n * Modify box-shadow x/y offsets to counteract rotation\r\n */\r\nfunction normalizeShadow(shadows, degrees) {\r\n    var normalized = [];\r\n    for (var _i = 0, shadows_1 = shadows; _i < shadows_1.length; _i++) {\r\n        var shadow = shadows_1[_i];\r\n        var xy = convertOffset(shadow.x, shadow.y, degrees);\r\n        normalized.push(shadow.prefix + xy[0] + shadow.xUnits + ' ' + xy[1] + shadow.yUnits + shadow.end);\r\n    }\r\n    return normalized.join(', ');\r\n}\r\nfunction convertOffset(x, y, degrees) {\r\n    var radians = degrees * Math.PI / 180;\r\n    var sin = Math.sin(radians);\r\n    var cos = Math.cos(radians);\r\n    return [\r\n        Math.round((x * cos + y * sin) * 1000) / 1000,\r\n        Math.round((-x * sin + y * cos) * 1000) / 1000,\r\n    ];\r\n}\r\n","import \"jqtree\";\nimport { Spinner } from \"spin.js\";\nimport * as cookie from \"cookie\";\nimport * as URL from \"url-parse\";\nimport * as qs from \"querystringify\";\n\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\ninterface JQTreeMoveEvent extends JQuery.Event {\n    move_info: {\n        moved_node: INode;\n        position: string;\n        target_node: INode;\n        do_move: () => void;\n    };\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\ninterface JQTreeSelectEvent extends JQuery.Event {\n    deselected_node: INode | null;\n    node: INode;\n}\n\ninterface Parameters {\n    animationSpeed: number | string | null;\n    autoOpen: boolean | number;\n    autoEscape: boolean;\n    csrfCookieName: string;\n    mouseDelay: number | null;\n    rtl: boolean;\n}\n\nfunction initTree(\n    $tree: JQuery,\n    {\n        animationSpeed,\n        autoOpen,\n        autoEscape,\n        csrfCookieName,\n        mouseDelay,\n        rtl,\n    }: Parameters\n) {\n    let errorNode: INode | null = null;\n    const insertAtUrl = new URL($tree.data(\"insert_at_url\"), true);\n\n    function createLi(node: INode, $li: JQuery, isSelected: boolean) {\n        // Create edit link\n        const $title = $li.find(\".jqtree-title\");\n\n        insertAtUrl.query.insert_at = `${node.id as string | number}`;\n\n        const insertUrlString = urlToString(insertAtUrl);\n\n        const tabindex = isSelected ? \"0\" : \"-1\";\n\n        $title.after(\n            `<a href=\"${\n                node.url as string\n            }\" class=\"edit\" tabindex=\"${tabindex}\">(${gettext(\"edit\")})</a>`,\n            `<a href=\"${insertUrlString}\" class=\"edit\" tabindex=\"${tabindex}\">(${gettext(\n                \"add\"\n            )})</a>`\n        );\n    }\n\n    function getCsrfToken() {\n        function getFromMiddleware() {\n            return (document.querySelector(\n                '[name=\"csrfmiddlewaretoken\"]'\n            ) as HTMLInputElement).value;\n        }\n\n        function getFromCookie() {\n            if (!csrfCookieName) {\n                return null;\n            } else {\n                return cookie.parse(document.cookie)[csrfCookieName];\n            }\n        }\n\n        return getFromCookie() || getFromMiddleware();\n    }\n\n    function handleMove(eventParam: JQuery.Event) {\n        const e = eventParam as JQTreeMoveEvent;\n        const info = e.move_info;\n        const data = {\n            target_id: info.target_node.id,\n            position: info.position,\n        };\n        const $el = jQuery(info.moved_node.element);\n\n        handleLoading(true, null, $el);\n\n        removeErrorMessage();\n\n        e.preventDefault();\n\n        void jQuery.ajax({\n            type: \"POST\",\n            url: info.moved_node.move_url as string,\n            data,\n            beforeSend: (xhr) => {\n                // Set Django csrf token\n                xhr.setRequestHeader(\"X-CSRFToken\", getCsrfToken());\n            },\n            success: () => {\n                info.do_move();\n                handleLoading(false, null, $el);\n            },\n            error: () => {\n                handleLoading(false, null, $el);\n                const $node = $el.find(\".jqtree-element\");\n                $node.append(\n                    `<span class=\"mptt-admin-error\">${gettext(\n                        \"move failed\"\n                    )}</span>`\n                );\n\n                errorNode = info.moved_node;\n            },\n        });\n\n        function removeErrorMessage() {\n            if (errorNode) {\n                jQuery(errorNode.element).find(\".mptt-admin-error\").remove();\n                errorNode = null;\n            }\n        }\n    }\n\n    function handleLoadFailed() {\n        $tree.html(gettext(\"Error while loading the data from the server\"));\n    }\n\n    const spinners: Record<number | string, Spinner | null> = {};\n\n    function handleLoading(\n        isLoading: boolean,\n        node: INode | null,\n        $el: JQuery\n    ) {\n        function getNodeId(): string | number {\n            if (!node) {\n                return \"__root__\";\n            } else {\n                return node.id as string | number;\n            }\n        }\n\n        function getContainer() {\n            if (node) {\n                return $el.find(\".jqtree-element\")[0];\n            } else {\n                return $el[0];\n            }\n        }\n\n        const nodeId = getNodeId();\n\n        if (isLoading) {\n            spinners[nodeId] = new Spinner().spin(getContainer());\n        } else {\n            const spinner = spinners[nodeId];\n\n            if (spinner) {\n                spinner.stop();\n                spinners[nodeId] = null;\n            }\n        }\n    }\n\n    function handleSelect(eventParam: JQuery.Event) {\n        const e = eventParam as JQTreeSelectEvent;\n        const { node, deselected_node } = e;\n\n        if (deselected_node) {\n            // deselected node: remove tabindex\n            jQuery(deselected_node.element).find(\".edit\").attr(\"tabindex\", -1);\n        }\n\n        if (node) {\n            // selected: add tabindex\n            jQuery(node.element).find(\".edit\").attr(\"tabindex\", 0);\n        }\n    }\n\n    const treeOptions: Record<string, unknown> = {\n        autoOpen,\n        autoEscape,\n        buttonLeft: rtl,\n        closedIcon: rtl ? \"&#x25c0;\" : \"&#x25ba;\",\n        dragAndDrop: true,\n        onCreateLi: createLi,\n        onLoadFailed: handleLoadFailed,\n        onLoading: handleLoading,\n        saveState: $tree.data(\"save_state\") as boolean,\n        useContextMenu: Boolean($tree.data(\"use_context_menu\")),\n    };\n\n    if (animationSpeed !== null) {\n        treeOptions[\"animationSpeed\"] = animationSpeed;\n    }\n\n    $tree.tree(treeOptions);\n\n    $tree.on(\"tree.move\", handleMove);\n    $tree.on(\"tree.select\", handleSelect);\n\n    if (mouseDelay !== null) {\n        $tree.tree(\"setMouseDelay\", mouseDelay);\n    }\n}\n\nfunction urlToString(url: URL): string {\n    const { pathname, query } = url;\n    const querystring = qs.stringify(query);\n\n    if (!querystring) {\n        return pathname;\n    } else {\n        return `${pathname}?${querystring}`;\n    }\n}\n\njQuery(() => {\n    const $tree = jQuery(\"#tree\");\n\n    if ($tree.length) {\n        const animationSpeed = $tree.data(\"tree-animation-speed\") as\n            | number\n            | string\n            | null;\n        const autoOpen = $tree.data(\"auto_open\") as boolean | number;\n        const autoEscape = Boolean($tree.data(\"autoescape\"));\n        const mouseDelay = $tree.data(\"tree-mouse-delay\") as number | null;\n        const rtl = $tree.data(\"rtl\") === \"1\";\n        const csrfCookieName = $tree.data(\"csrf-cookie-name\") as string;\n\n        initTree($tree, {\n            animationSpeed,\n            autoOpen,\n            autoEscape,\n            csrfCookieName,\n            mouseDelay,\n            rtl,\n        });\n    }\n});\n"],"sourceRoot":""}